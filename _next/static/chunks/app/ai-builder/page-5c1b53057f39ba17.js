(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[327],{23195:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>ec});var n=t(54568),l=t(7620),r=t(32545),s=t(78021),o=t(87606),i=t(42387),c=t(52843),d=t(73297);let m=c.Ik({provider:c.k5(["openai","anthropic","google","mistral","openrouter","openai-compatible"]).optional(),model:c.Yj().optional(),apiKey:c.Yj().optional(),temperature:c.ai().min(0).max(2).default(.7),maxTokens:c.ai().min(1).max(32768).default(16384),endpoint:c.Yj().url().optional()}),u=[{value:"openai",label:"OpenAI",requiresKey:!0},{value:"anthropic",label:"Anthropic",requiresKey:!0},{value:"google",label:"Google Gemini",requiresKey:!0},{value:"mistral",label:"Mistral",requiresKey:!0},{value:"openrouter",label:"OpenRouter",requiresKey:!0},{value:"openai-compatible",label:"OpenAI Compatible",requiresKey:!1}],p=function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],t=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return"openai"===e?[{value:"gpt-4o",label:"GPT-4o"},{value:"gpt-4o-mini",label:"GPT-4o Mini"},{value:"gpt-4-turbo",label:"GPT-4 Turbo"},{value:"gpt-4",label:"GPT-4"},{value:"gpt-3.5-turbo",label:"GPT-3.5 Turbo"},{value:"gpt-4o-2024-08-06",label:"GPT-4o (2024-08-06)"},{value:"gpt-4o-mini-2024-07-18",label:"GPT-4o Mini (2024-07-18)"}]:"anthropic"===e?[{value:"claude-opus-4-1-20250805",label:"Claude Opus 4.1"},{value:"claude-opus-4-20250514",label:"Claude Opus 4"},{value:"claude-sonnet-4-20250514",label:"Claude Sonnet 4"},{value:"claude-3-7-sonnet-20250219",label:"Claude 3.7 Sonnet"},{value:"claude-3-5-haiku-20241022",label:"Claude 3.5 Haiku"},{value:"claude-3-haiku-20240307",label:"Claude 3 Haiku"}]:"google"===e?[{value:"gemini-2.5-pro",label:"Gemini 2.5 Pro"},{value:"gemini-2.5-flash",label:"Gemini 2.5 Flash"},{value:"gemini-2.5-flash-lite",label:"Gemini 2.5 Flash Lite"},{value:"gemini-2.0-flash",label:"Gemini 2.0 Flash"}]:"mistral"===e?[{value:"mistral-large-2411",label:"Mistral Large 2.1"},{value:"mistral-medium-2508",label:"Mistral Medium 3.1"},{value:"codestral-2508",label:"Codestral 2508"},{value:"ministral-8b-2410",label:"Ministral 8B"},{value:"ministral-3b-2410",label:"Ministral 3B"},{value:"mistral-small-2506",label:"Mistral Small 3.2"}]:"openrouter"===e?t?[{value:"loading",label:"Loading models..."}]:a.length>0?a.filter(e=>e.value&&""!==e.value.trim()):[{value:"openai/gpt-5",label:"OpenAI GPT-5"},{value:"openai/gpt-5-mini",label:"OpenAI GPT-5 Mini"},{value:"openai/o3-pro",label:"OpenAI o3 Pro"},{value:"openai/o3-mini",label:"OpenAI o3 Mini"},{value:"anthropic/claude-opus-4.1",label:"Anthropic Claude Opus 4.1"},{value:"anthropic/claude-sonnet-4",label:"Anthropic Claude Sonnet 4"},{value:"google/gemini-2.5-pro",label:"Google Gemini 2.5 Pro"},{value:"deepseek/deepseek-r1",label:"DeepSeek R1"},{value:"mistralai/mistral-medium-3.1",label:"Mistral Medium 3.1"},{value:"qwen/qwen3-235b-a22b",label:"Qwen Qwen3 235B A22B"}]:[]},h=async e=>{let a=await fetch("https://openrouter.ai/api/v1/models",{headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(!a.ok)throw Error("HTTP error! status: ".concat(a.status));return(await a.json()).data.filter(e=>e.id&&e.name&&""!==e.id.trim()).map(e=>({value:e.id,label:"".concat(e.name," (").concat(e.id,")")})).sort((e,a)=>e.label.localeCompare(a.label))};function f(e){let{onConfigChange:a,initialConfig:t,className:r}=e,[s,o]=(0,l.useState)((null==t?void 0:t.apiKey)||""),[c,f]=(0,l.useState)(null==t?void 0:t.provider),{data:g=[],isLoading:b,error:x}=(0,d.I)({queryKey:["openrouter-models",s],queryFn:()=>h(s),enabled:"openrouter"===c&&!!s&&s.length>0,staleTime:3e5,gcTime:6e5,retry:1}),{Form:v,form:y}=(0,i.X)({schema:m,layout:{type:"grid",columns:2,gap:"lg"},fields:[{name:"provider",type:"select",label:"AI Provider",placeholder:"Select provider...",gridColumn:1,options:u.map(e=>({value:e.value,label:e.label}))},{name:"apiKey",type:"text",label:"API Key",placeholder:"sk-...",gridColumn:2,conditional:e=>!!e.provider,help:{tooltip:"Your API key is stored securely and never sent to our servers"}},{name:"model",type:"select",label:"Model",placeholder:"Select model...",gridColumn:1,options:e=>{let a=p(e.provider,g,b);return"openrouter"===e.provider&&x?[{value:"error",label:"Failed to load models - check API key"}]:a},conditional:e=>!!e.provider},{name:"temperature",type:"slider",label:"Temperature",description:"Controls randomness: 0 = focused, 2 = creative",gridColumn:2,sliderConfig:{min:0,max:2,step:.1,showValue:!0,marks:[{value:0,label:"Focused"},{value:1,label:"Balanced"},{value:2,label:"Creative"}]},conditional:e=>!!e.provider},{name:"endpoint",type:"text",label:"API Endpoint",placeholder:"https://api.example.com/v1",conditional:e=>"openai-compatible"===e.provider,gridColumn:1,description:"Base URL for OpenAI-compatible API"},{name:"maxTokens",type:"number",label:"Max Tokens",placeholder:"16384",description:"Maximum response length",gridColumn:2,numberConfig:{min:1,max:32768,step:1},conditional:e=>!!e.provider}],formOptions:{defaultValues:{provider:null==t?void 0:t.provider,model:(null==t?void 0:t.model)||"",apiKey:(null==t?void 0:t.apiKey)||"",endpoint:(null==t?void 0:t.endpoint)||"",temperature:(null==t?void 0:t.temperature)||.7,maxTokens:(null==t?void 0:t.maxTokens)||16384},onSubmit:async e=>{let{value:t}=e;a({provider:t.provider,apiKey:t.apiKey||"",model:t.model,temperature:t.temperature,maxTokens:t.maxTokens,...t.endpoint&&{endpoint:t.endpoint}})}},submitLabel:"\uD83D\uDCBE Save Configuration",showSubmitButton:!0,autoSubmitOnChange:!1});return(0,l.useEffect)(()=>{let e=y.store.subscribe(()=>{let e=y.state.values.provider;e!==c&&f(e)}),a=y.store.subscribe(()=>{let e=y.state.values.apiKey;e&&e!==s&&o(e)});return()=>{e(),a()}},[y,c,s]),(0,n.jsx)(v,{})}var g=t(58950),b=t(78514),x=t(93492),v=t(61038),y=t(56479),j=t(30142),N=t(34118),w=t(47227),C=t(17129),S=t(63353),A=t(83908),E=t(64529),k=t(60066),I=t(19594),O=t(49369),T=t(62501),L=t(39690),F=t(8024),D=t(43755),P=t(70111),_=t(93204),z=t(93928);function R(e){let a=e.match(/```formedible\s*\n([\s\S]*?)\n```/);return a&&a[1]?a[1].trim():null}function M(e,a,t){let n=[];return e.forEach((e,l)=>{if("assistant"===e.role&&e.content){let r=R(e.content);r&&n.push({id:a?"form_".concat(a,"_").concat(l):"form_".concat(Date.now(),"_").concat(l),code:r,timestamp:t||new Date})}}),n}function G(e){let a,{content:t}=e,l=/```(\w+)?\s*\n([\s\S]*?)\n```/g,r=[],s=0;for(;null!==(a=l.exec(t));){a.index>s&&r.push((0,n.jsx)("span",{className:"whitespace-pre-wrap break-words leading-relaxed",children:t.slice(s,a.index)},"text-".concat(s)));let e=a[1]||"text",l=a[2];r.push((0,n.jsx)("div",{className:"my-2",children:(0,n.jsx)(_.N,{code:l,language:e,showLineNumbers:!1,showCopyButton:!0,className:"text-xs",darkMode:!0,scrollable:!1})},"code-".concat(a.index))),s=a.index+a[0].length}return s<t.length&&r.push((0,n.jsx)("span",{className:"whitespace-pre-wrap break-words leading-relaxed",children:t.slice(s)},"text-".concat(s))),(0,n.jsx)("div",{className:"space-y-1",children:r.length>0?r:(0,n.jsx)("span",{className:"whitespace-pre-wrap break-words leading-relaxed",children:t})})}function q(e){let{onFormGenerated:a,onStreamingStateChange:t,onConversationUpdate:r,onNewConversation:s,messages:o,className:i,providerConfig:c}=e,[d,m]=(0,l.useState)(""),[u,p]=(0,l.useState)(o||[]),[h,f]=(0,l.useState)(!1),[_,M]=(0,l.useState)(null),[q,Z]=(0,l.useState)(!1),B=(0,l.useRef)(null),V=(0,l.useRef)(null),K=(0,l.useRef)(null),J=(0,l.useCallback)(()=>{var e;null==(e=B.current)||e.scrollIntoView({behavior:"smooth"})},[]),$=(0,l.useCallback)(()=>{if(!V.current)return;let{scrollTop:e,scrollHeight:a,clientHeight:t}=V.current;Z(!(a-e-t<100)&&u.length>0)},[u.length]);(0,l.useEffect)(()=>{void 0!==o&&p(o)},[o]),(0,l.useEffect)(()=>{let e=V.current;if(e)return e.addEventListener("scroll",$),$(),()=>e.removeEventListener("scroll",$)},[$]);let U=e=>{let{provider:a,apiKey:t,model:n,endpoint:l}=e;switch(a){case"openai":return(0,b.r)({apiKey:t})(n||"gpt-5");case"anthropic":return(0,x.n)({apiKey:t})(n||"claude-sonnet-4");case"google":return(0,v.s)({apiKey:t})(n||"gemini-2.5-pro");case"mistral":return(0,y.T)({apiKey:t})(n||"mistral-large-2407");case"openrouter":return(0,j.ER)({apiKey:t}).chat(n||"openrouter/kimiplus-k2");case"openai-compatible":if(!l)throw Error("Endpoint required for OpenAI-compatible providers");return(0,N.jr)({name:"openai-compatible",baseURL:l,...t&&{apiKey:t}})(n||"gpt-4.1-mini");default:throw Error("Unsupported provider")}},Y=async e=>{if(!c)return void M(Error("Provider configuration required"));try{f(!0),M(null),null==t||t(!0);let n={id:Date.now().toString(),role:"user",content:e},l=[...u,n];p(l);let s=U(c),o=new AbortController;K.current=o;let i=(0,g.gM)({model:s,system:"You are a helpful AI assistant for form creation. You can chat naturally with users about forms, answer questions, and help them design forms.\n\n**IMPORTANT: Only show formedible code blocks when the user specifically asks to create, build, generate, or show a form.**\n\nWhen creating forms, use formedible code blocks with complete JavaScript object literal syntax including Zod schemas:\n\n```formedible\n{\n  schema: z.object({\n    firstName: z.string().min(1, 'First name is required'),\n    email: z.string().email('Please enter a valid email address'),\n    age: z.number().min(18, 'Must be 18 or older').optional(),\n    newsletter: z.boolean().default(false)\n  }),\n  fields: [\n    {\n      name: 'firstName',\n      type: 'text',\n      label: 'First Name',\n      placeholder: 'Enter your first name'\n    },\n    {\n      name: 'email',\n      type: 'email', \n      label: 'Email Address',\n      placeholder: 'your@email.com'\n    },\n    {\n      name: 'age',\n      type: 'number',\n      label: 'Age',\n      placeholder: '18+'\n    },\n    {\n      name: 'newsletter',\n      type: 'checkbox',\n      label: 'Subscribe to newsletter'\n    }\n  ],\n  formOptions: {\n    defaultValues: {\n      firstName: '',\n      email: '',\n      newsletter: false\n    }\n  }\n}\n```\n\n**CRITICAL REQUIREMENTS:**\n- ALWAYS include complete Zod schema with proper validation\n- Use JavaScript object literals (unquoted keys, single quotes for strings) \n- Match schema field names EXACTLY with field names\n- Include proper Zod validations: .min(), .max(), .email(), .optional(), .default()\n- Available field types: text, email, password, tel, textarea, select, checkbox, switch, number, date, slider, file, rating, phone, colorPicker, location, duration, multiSelect, autocomplete, masked, object, array, radio\n\n**Zod Schema Examples:**\n- z.string().min(1, 'Required') - required text\n- z.string().email('Invalid email') - email validation  \n- z.number().min(18, 'Must be 18+') - number with min\n- z.boolean().default(false) - checkbox with default\n- z.string().optional() - optional field\n- z.enum(['option1', 'option2']) - select options\n- z.array(z.string()) - multiSelect\n\n**ARRAY FIELDS - Use arrayConfig with proper configuration:**\n\nSimple string arrays:\n```javascript\n{\n  name: 'contactMethods',\n  type: 'array',\n  label: 'Contact Email Addresses',\n  arrayConfig: {\n    itemType: 'email',\n    itemLabel: 'Email Address',\n    itemPlaceholder: 'contact@company.com',\n    minItems: 1,\n    maxItems: 5,\n    addButtonLabel: 'Add Email',\n    removeButtonLabel: 'Remove',\n    defaultValue: ''\n  }\n}\n```\n\nComplex object arrays:\n```javascript\n{\n  name: 'teamMembers',\n  type: 'array',\n  label: 'Team Members',\n  arrayConfig: {\n    itemType: 'object',\n    itemLabel: 'Team Member',\n    minItems: 1,\n    maxItems: 10,\n    sortable: true,\n    addButtonLabel: 'Add Team Member',\n    removeButtonLabel: 'Remove Member',\n    defaultValue: {\n      name: '',\n      email: '',\n      role: 'developer'\n    },\n    objectConfig: {\n      fields: [\n        {\n          name: 'name',\n          type: 'text',\n          label: 'Name',\n          placeholder: 'Enter name'\n        },\n        {\n          name: 'email',\n          type: 'text',\n          label: 'Email',\n          placeholder: 'Enter email'\n        },\n        {\n          name: 'role',\n          type: 'select',\n          label: 'Role',\n          options: [\n            { value: 'developer', label: 'Developer' },\n            { value: 'designer', label: 'Designer' }\n          ]\n        }\n      ]\n    }\n  }\n}\n```\n\n**STANDALONE OBJECT FIELDS - Use objectConfig with fields:**\n\n```javascript\n{\n  name: 'atmosphericConditions',\n  type: 'object',\n  label: 'Atmospheric Conditions',\n  description: 'Fundamental atmospheric parameters',\n  objectConfig: {\n    title: 'Atmospheric Parameters',\n    collapsible: true,\n    defaultExpanded: true,\n    columns: 2,\n    layout: 'grid',\n    fields: [\n      {\n        name: 'altitude',\n        type: 'number',\n        label: 'Altitude',\n        placeholder: 'Enter altitude in meters'\n      },\n      {\n        name: 'pressure',\n        type: 'number',\n        label: 'Pressure',\n        placeholder: 'Enter pressure in hPa'\n      },\n      {\n        name: 'temperature',\n        type: 'slider',\n        label: 'Temperature',\n        min: -50,\n        max: 50,\n        step: 1\n      }\n    ]\n  }\n}\n```\n\n**NESTED OBJECT FIELDS - Objects inside objects:**\n\n```javascript\n{\n  name: 'location',\n  type: 'object',\n  label: 'Location Details',\n  objectConfig: {\n    fields: [\n      {\n        name: 'coordinates',\n        type: 'object',\n        label: 'GPS Coordinates',\n        objectConfig: {\n          fields: [\n            {\n              name: 'latitude',\n              type: 'number',\n              label: 'Latitude',\n              placeholder: 'Enter latitude'\n            },\n            {\n              name: 'longitude',\n              type: 'number',\n              label: 'Longitude',\n              placeholder: 'Enter longitude'\n            }\n          ]\n        }\n      }\n    ]\n  }\n}\n```\n\n**Optional properties:**\n- pages: [...] for multi-page forms\n- progress: { showSteps: true, showPercentage: false }\n- submitLabel: 'Submit Form'\n- formOptions: { defaultValues: {...}, onSubmit: async (data) => {...} }\n\nChat naturally. Ask clarifying questions. Suggest improvements. Only output formedible blocks when specifically requested.",messages:[...u,n].map(e=>({role:e.role,content:e.content})),temperature:c.temperature||.7,maxOutputTokens:c.maxTokens||2e3,abortSignal:o.signal}),d={id:(Date.now()+1).toString(),role:"assistant",content:""};p(e=>[...e,d]);let m="";for await(let e of i.textStream){if(o.signal.aborted)break;m+=e,p(e=>e.map(e=>e.id===d.id?{...e,content:m}:e))}if(m&&a){let e=R(m);e&&a(e)}null==t||t(!1);let h=[...l,{...d,content:m}];null==r||r(h,!0)}catch(e){console.error("AI Generation Error:",e),M(e instanceof Error?e:Error("Unknown error occurred"))}finally{f(!1),null==t||t(!1),K.current=null}},W=e=>{e.preventDefault(),d.trim()&&!h&&c&&(m(""),Y(d))};return(0,n.jsxs)(S.Zp,{className:(0,z.cn)("flex flex-col h-full border-2 border-accent/30 shadow-lg !py-0 !gap-0",i),children:[(0,n.jsx)(S.aR,{className:"px-3 pt-1 pb-0 bg-gradient-to-r from-accent/10 to-transparent",children:(0,n.jsxs)(S.ZB,{className:"flex items-center justify-between text-lg",children:[(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[(0,n.jsx)("div",{className:"p-2 bg-accent/20 rounded-lg",children:(0,n.jsx)(A.A,{className:"h-5 w-5 text-accent-foreground"})}),(0,n.jsx)("span",{className:"text-foreground font-semibold",children:"AI Form Builder Chat"})]}),s&&(0,n.jsxs)(w.$,{variant:"outline",size:"sm",onClick:s,className:"h-8 w-8 p-0",children:[(0,n.jsx)(E.A,{className:"h-4 w-4"}),(0,n.jsx)("span",{className:"sr-only",children:"New conversation"})]})]})}),(0,n.jsxs)(S.Wu,{className:"flex flex-col flex-1 px-3 pt-0 pb-1 min-h-0 relative",children:[(0,n.jsxs)("div",{ref:V,className:"flex-1 overflow-y-auto space-y-3 mb-1 pr-2 min-h-0 max-h-full",children:[0===u.length&&(0,n.jsxs)("div",{className:"flex flex-col items-center justify-center h-full text-center text-muted-foreground",children:[(0,n.jsx)(k.A,{className:"h-12 w-12 mb-4 opacity-50"}),(0,n.jsx)("h3",{className:"text-lg font-medium mb-2",children:"Welcome to AI Form Builder"}),(0,n.jsx)("p",{className:"text-sm max-w-md",children:'Describe the form you want to create and I\'ll generate it for you. Try something like "Create a contact form with name, email, and message fields"'})]}),u.map(e=>(0,n.jsxs)("div",{className:(0,z.cn)("flex gap-3 max-w-4xl","user"===e.role?"ml-auto flex-row-reverse":"mr-auto"),children:[(0,n.jsx)("div",{className:(0,z.cn)("flex h-8 w-8 shrink-0 select-none items-center justify-center rounded-full border-2 shadow-md","user"===e.role?"bg-primary text-primary-foreground border-primary/30":"bg-muted text-foreground border-border"),children:"user"===e.role?(0,n.jsx)(I.A,{className:"h-4 w-4"}):(0,n.jsx)(k.A,{className:"h-4 w-4"})}),(0,n.jsx)("div",{className:(0,z.cn)("flex flex-col gap-2 rounded-lg px-4 py-3 text-sm shadow-md border max-w-[85%]","user"===e.role?"bg-primary text-primary-foreground border-primary/30":"bg-background text-foreground border-border"),children:(0,n.jsx)(G,{content:e.content})})]},e.id)),h&&(0,n.jsxs)("div",{className:"flex gap-3 max-w-4xl mr-auto",children:[(0,n.jsx)("div",{className:"flex h-8 w-8 shrink-0 select-none items-center justify-center rounded-full border-2 shadow-md bg-muted text-foreground border-border",children:(0,n.jsx)(k.A,{className:"h-4 w-4"})}),(0,n.jsxs)("div",{className:"flex items-center gap-2 rounded-lg px-4 py-3 text-sm shadow-md border bg-background text-foreground border-border",children:[(0,n.jsx)(O.A,{className:"h-4 w-4 animate-spin text-primary"}),(0,n.jsx)("span",{children:"Generating response..."})]})]}),(0,n.jsx)("div",{ref:B})]}),q&&(0,n.jsxs)(w.$,{onClick:J,className:"absolute bottom-20 right-4 rounded-full w-10 h-10 p-0 shadow-lg z-10",variant:"secondary",size:"sm",children:[(0,n.jsx)(T.A,{className:"h-4 w-4"}),(0,n.jsx)("span",{className:"sr-only",children:"Scroll to bottom"})]}),_&&(0,n.jsxs)(P.Fc,{variant:"destructive",className:"mb-4",children:[(0,n.jsx)(L.A,{className:"h-4 w-4"}),(0,n.jsx)(P.TN,{children:"Failed to send message. Please check your configuration and try again."})]}),(0,n.jsxs)("form",{onSubmit:W,className:"flex gap-2",children:[(0,n.jsx)(C.T,{value:d,onChange:e=>m(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),W(e))},placeholder:"Describe the form you want to create... (Shift+Enter for new line)",disabled:h,className:"flex-1 min-h-[80px] resize-none",rows:3}),h?(0,n.jsxs)(w.$,{type:"button",variant:"outline",size:"icon",onClick:()=>{K.current&&(K.current.abort(),f(!1))},className:"shrink-0",children:[(0,n.jsx)(F.A,{className:"h-4 w-4"}),(0,n.jsx)("span",{className:"sr-only",children:"Stop generation"})]}):(0,n.jsxs)(w.$,{type:"submit",disabled:!d.trim(),size:"icon",className:"shrink-0",children:[(0,n.jsx)(D.A,{className:"h-4 w-4"}),(0,n.jsx)("span",{className:"sr-only",children:"Send message"})]})]})]})]})}var Z=t(80318);class B{static parse(e,a){if(!e||"string"!=typeof e)throw Error("Input code must be a non-empty string");try{(null==a?void 0:a.strictValidation)!==void 0&&(this.CONFIG.ENABLE_STRICT_VALIDATION=a.strictValidation);let t=this.sanitizeCode(e),n=this.parseObjectLiteral(t);return this.validateAndSanitize(n)}catch(a){let e=a instanceof Error?a.message:String(a);throw Error("FormedibleParser: Failed to parse form definition - ".concat(e))}}static isValidFieldType(e){return this.ALLOWED_FIELD_TYPES.includes(e)}static getSupportedFieldTypes(){return[...this.ALLOWED_FIELD_TYPES]}static sanitizeCode(e){let a=e.replace(/\/\*[\s\S]*?\*\//g,"").replace(/\/\/.*$/gm,"");return(a=(a=(a=(a=a.replace(/\b(eval|Function|setTimeout|setInterval|require|import)\s*\(/g,"")).replace(/=>\s*{[^}]*}/g,'""')).replace(/function\s*\([^)]*\)\s*{[^}]*}/g,'""')).replace(/new\s+Date\(\)\.toISOString\(\)\.split\('[^']*'\)\[0\]/g,'"2024-01-01"')).replace(/new\s+Date\(\)/g,'"2024-01-01T00:00:00Z"')}static parseObjectLiteral(e){try{return JSON.parse(e)}catch(t){let a=e.trim();try{return a=(a=(a=(a=this.replaceZodExpressions(a)).replace(/([{,]\s*)([a-zA-Z_$][a-zA-Z0-9_$]*)\s*:/g,'$1"$2":')).replace(/,(\s*[}\]])/g,"$1")).replace(/'/g,'"'),JSON.parse(a)}catch(t){throw console.error("Failed to parse after conversion:",{originalCode:e.substring(0,200),processedCode:a.substring(0,200),error:t instanceof Error?t.message:String(t)}),Error("Invalid syntax. Please use valid JSON format or JavaScript object literal syntax. Error: ".concat(t instanceof Error?t.message:String(t)))}}}static replaceZodExpressions(e){let a=e,t=!0;for(;t;){t=!1;let e=a.match(/z\.[a-zA-Z]+\(/);if(e){let n=e.index,l=n+e[0].length-1,r=1,s=l+1;for(;s<a.length&&r>0;)"("===a[s]?r++:")"===a[s]&&r--,s++;if(0===r){let e=s;for(;e<a.length;){let t=a.slice(e).match(/^\.[a-zA-Z]+\(/);if(t){let n=1,l=e+t[0].length-1+1;for(;l<a.length&&n>0;)"("===a[l]?n++:")"===a[l]&&n--,l++;if(0===n)e=l;else break}else break}a=a.slice(0,n)+'"'.concat(this.CONFIG.ZOD_PLACEHOLDER,'"')+a.slice(e),t=!0}else a=a.replace(/z\.[a-zA-Z]+/,'"'.concat(this.CONFIG.ZOD_PLACEHOLDER,'"')),t=!0}}return a.replace(/z\.enum\(\[[^\]]*\]\)/g,'"'.concat(this.CONFIG.ZOD_PLACEHOLDER,'"'))}static validateAndSanitize(e){if("object"!=typeof e||null===e)throw Error("Definition must be an object");let a={fields:[]};for(let[t,n]of Object.entries(e))if(this.ALLOWED_KEYS.includes(t))switch(t){case"schema":a.schema=n;break;case"fields":a.fields=this.validateFields(n);break;case"pages":Array.isArray(n)&&(a.pages=n);break;case"title":"string"==typeof n&&(a.title=n);break;case"description":"string"==typeof n&&(a.description=n);break;case"submitLabel":"string"==typeof n&&(a.submitLabel=n);break;case"nextLabel":"string"==typeof n&&(a.nextLabel=n);break;case"previousLabel":"string"==typeof n&&(a.previousLabel=n);break;case"formClassName":"string"==typeof n&&(a.formClassName=n);break;case"fieldClassName":"string"==typeof n&&(a.fieldClassName=n);break;case"progress":a.progress=n;break;case"formOptions":a.formOptions=n}return a}static validateFields(e){if(!Array.isArray(e))throw Error("Fields must be an array");return e.map((e,a)=>{if("object"!=typeof e||null===e)throw Error("Field at index ".concat(a," must be an object"));if(!e.name||!e.type)throw Error("Field at index ".concat(a," must have 'name' and 'type' properties"));if("string"!=typeof e.name||"string"!=typeof e.type)throw Error("Field at index ".concat(a," must have string 'name' and 'type' properties"));if(!this.ALLOWED_FIELD_TYPES.includes(e.type))throw Error("Field at index ".concat(a," has invalid type '").concat(e.type,"'"));let t={name:e.name,type:e.type};if(e.label&&"string"==typeof e.label&&(t.label=e.label),e.placeholder&&"string"==typeof e.placeholder&&(t.placeholder=e.placeholder),e.description&&"string"==typeof e.description&&(t.description=e.description),"boolean"==typeof e.required&&(t.required=e.required),void 0!==e.defaultValue&&(t.defaultValue=e.defaultValue),"number"==typeof e.min&&(t.min=e.min),"number"==typeof e.max&&(t.max=e.max),"number"==typeof e.step&&(t.step=e.step),"boolean"==typeof e.required&&(t.required=e.required),e.arrayConfig&&"object"==typeof e.arrayConfig&&(t.arrayConfig=e.arrayConfig),e.objectConfig&&"object"==typeof e.objectConfig){let a=e.objectConfig,n={fields:a.fields?this.validateFields(a.fields).map(e=>({name:e.name,type:e.type,label:e.label,placeholder:e.placeholder,description:e.description,options:e.options,min:e.min,max:e.max,step:e.step})):[]};a.title&&"string"==typeof a.title&&(n.title=a.title),a.description&&"string"==typeof a.description&&(n.description=a.description),"boolean"==typeof a.collapsible&&(n.collapsible=a.collapsible),"boolean"==typeof a.defaultExpanded&&(n.defaultExpanded=a.defaultExpanded),"boolean"==typeof a.showCard&&(n.showCard=a.showCard),a.layout&&["vertical","horizontal","grid"].includes(a.layout)&&(n.layout=a.layout),"number"==typeof a.columns&&(n.columns=a.columns),a.collapseLabel&&"string"==typeof a.collapseLabel&&(n.collapseLabel=a.collapseLabel),a.expandLabel&&"string"==typeof a.expandLabel&&(n.expandLabel=a.expandLabel),t.objectConfig=n}return e.options&&Array.isArray(e.options)&&(t.options=e.options.filter(e=>"object"==typeof e&&null!==e&&"string"==typeof e.value&&"string"==typeof e.label).map(e=>({value:e.value,label:e.label}))),void 0!==e.validation&&null!==e.validation&&"object"==typeof e.validation&&(t.validation=e.validation),void 0!==e.multiSelectConfig&&null!==e.multiSelectConfig&&"object"==typeof e.multiSelectConfig&&(t.multiSelectConfig=e.multiSelectConfig),void 0!==e.colorConfig&&null!==e.colorConfig&&"object"==typeof e.colorConfig&&(t.colorConfig=e.colorConfig),void 0!==e.ratingConfig&&null!==e.ratingConfig&&"object"==typeof e.ratingConfig&&(t.ratingConfig=e.ratingConfig),void 0!==e.phoneConfig&&null!==e.phoneConfig&&"object"==typeof e.phoneConfig&&(t.phoneConfig=e.phoneConfig),void 0!==e.datalist&&null!==e.datalist&&"object"==typeof e.datalist&&(t.datalist=e.datalist),t})}}B.ALLOWED_FIELD_TYPES=["text","email","password","url","tel","textarea","select","checkbox","switch","number","date","slider","file","rating","phone","colorPicker","location","duration","multiSelect","autocomplete","masked","object","array","radio"],B.ALLOWED_KEYS=["schema","fields","pages","progress","submitLabel","nextLabel","previousLabel","formClassName","fieldClassName","formOptions","title","description"],B.CONFIG={ZOD_PLACEHOLDER:"__ZOD_SCHEMA__",MAX_RECURSION_DEPTH:10,ENABLE_STRICT_VALIDATION:!0};var V=t(93425);function K(e){let{formCode:a,isStreaming:t=!1,onFormSubmit:r,className:s,title:o="Form Preview",emptyStateMessage:i="No form generated yet. The preview will appear here once a form is created."}=e,c=(0,l.useMemo)(()=>{if(!a)return null;try{console.log("Attempting to parse form code:",{codeLength:a.length,codePreview:a.substring(0,200)+"..."});let e=B.parse(a);return console.log("Successfully parsed form config:",{fieldsCount:e.fields.length,hasSchema:!!e.schema,title:e.title}),e}catch(e){return console.error("Error parsing form configuration:",{error:e instanceof Error?e.message:String(e),formCodePreview:a.substring(0,500)}),null}},[a]);return a||t?(0,n.jsx)(S.Zp,{className:(0,z.cn)("flex flex-col h-full",s),children:(0,n.jsx)(S.Wu,{className:(0,z.cn)("flex-1 overflow-hidden","p-0"),children:(0,n.jsxs)("div",{className:"h-full",children:[t&&!a&&(0,n.jsx)("div",{className:"p-3",children:(0,n.jsxs)(P.Fc,{children:[(0,n.jsx)(L.A,{className:"h-4 w-4"}),(0,n.jsx)(P.TN,{children:"Form is being generated... Please wait for completion."})]})}),a&&c&&(0,n.jsx)(Z.b,{config:c,code:a,showModeSelector:!0,showDeviceSelector:!0,onFormSubmit:r,className:"border-0 h-full"}),a&&!c&&(0,n.jsx)("div",{className:"p-3",children:(0,n.jsxs)(P.Fc,{variant:"destructive",children:[(0,n.jsx)(L.A,{className:"h-4 w-4"}),(0,n.jsx)(P.TN,{children:"Failed to parse the form configuration. The form may have invalid syntax."})]})})]})})}):(0,n.jsx)(S.Zp,{className:(0,z.cn)("flex flex-col h-full",s),children:(0,n.jsx)(S.Wu,{className:"flex-1 flex items-center justify-center",children:(0,n.jsxs)("div",{className:"text-center text-muted-foreground",children:[(0,n.jsx)(V.A,{className:"h-12 w-12 mb-4 opacity-50 mx-auto"}),(0,n.jsx)("h3",{className:"text-lg font-medium mb-2",children:"No Form Available"}),(0,n.jsx)("p",{className:"text-sm max-w-md",children:i})]})})})}var J=t(85958),$=t(15870),U=t(27911),Y=t(68262);function W(e){let{forms:a,currentFormIndex:t,onFormIndexChange:l,onDeleteForm:r,isStreaming:s=!1,onFormSubmit:o,className:i}=e,c=a[t];return 0!==a.length||s?(0,n.jsxs)(S.Zp,{className:(0,z.cn)("flex flex-col h-full",i),children:[(0,n.jsx)(S.aR,{className:"px-3 pt-1 pb-0",children:(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)(S.ZB,{className:"flex items-center gap-2",children:[(0,n.jsx)(J.A,{className:"h-5 w-5"}),"Preview",a.length>0&&(0,n.jsxs)("span",{className:"text-sm font-normal text-muted-foreground",children:["(",t+1," of ",a.length,")"]})]}),a.length>1&&(0,n.jsxs)("div",{className:"flex items-center gap-1",children:[(0,n.jsxs)(w.$,{variant:"outline",size:"sm",onClick:()=>l(Math.max(0,t-1)),disabled:0===t,className:"h-8 w-8 p-0",children:[(0,n.jsx)($.A,{className:"h-4 w-4"}),(0,n.jsx)("span",{className:"sr-only",children:"Previous form"})]}),(0,n.jsxs)(w.$,{variant:"outline",size:"sm",onClick:()=>l(Math.min(a.length-1,t+1)),disabled:t===a.length-1,className:"h-8 w-8 p-0",children:[(0,n.jsx)(U.A,{className:"h-4 w-4"}),(0,n.jsx)("span",{className:"sr-only",children:"Next form"})]}),r&&a.length>1&&(0,n.jsxs)(w.$,{variant:"outline",size:"sm",onClick:()=>r(t),className:"h-8 w-8 p-0 text-destructive hover:text-destructive",children:[(0,n.jsx)(Y.A,{className:"h-4 w-4"}),(0,n.jsx)("span",{className:"sr-only",children:"Delete form"})]})]})]})}),(0,n.jsx)(S.Wu,{className:"flex-1 overflow-hidden",children:(0,n.jsx)(K,{formCode:null==c?void 0:c.code,isStreaming:s&&!c,onFormSubmit:o,className:"border-0 h-full"})})]}):(0,n.jsx)(K,{className:i,title:"",emptyStateMessage:"Start a conversation in the chat to generate your first form. The preview will appear here once the AI creates your form."})}var H=t(64148),Q=t(4595),X=t(93385);function ee(e){let{conversations:a,currentConversationId:t,onSelectConversation:l,onDeleteConversation:r,onNewConversation:s,onExportConversation:o,className:i}=e,c=e=>{let a=(new Date().getTime()-e.getTime())/36e5;return a<1?"Just now":a<24?"".concat(Math.floor(a),"h ago"):e.toLocaleDateString()},d=e=>{var a;if(e.title)return e.title;let t=null==(a=e.messages)?void 0:a.find(e=>"user"===e.role);if(null==t?void 0:t.content){let e=t.content;return e.length>50?e.substring(0,50)+"...":e}return"New Conversation"};return(0,n.jsxs)(S.Zp,{className:(0,z.cn)("h-full",i),children:[(0,n.jsx)(S.aR,{className:"pb-3",children:(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)(S.ZB,{className:"flex items-center gap-2",children:[(0,n.jsx)(Q.A,{className:"h-5 w-5"}),"Conversation History",(0,n.jsx)(H.E,{variant:"secondary",children:a.length})]}),s&&(0,n.jsxs)(w.$,{variant:"outline",size:"sm",onClick:s,className:"h-8 w-8 p-0",children:[(0,n.jsx)(E.A,{className:"h-4 w-4"}),(0,n.jsx)("span",{className:"sr-only",children:"New conversation"})]})]})}),(0,n.jsx)(S.Wu,{className:"p-4",children:(0,n.jsx)("div",{className:"h-[300px] overflow-y-auto",children:0===a.length?(0,n.jsxs)("div",{className:"flex flex-col items-center justify-center h-full text-center text-muted-foreground py-8",children:[(0,n.jsx)(A.A,{className:"h-8 w-8 mb-2 opacity-50"}),(0,n.jsx)("p",{className:"text-sm",children:"No conversations yet"}),(0,n.jsx)("p",{className:"text-xs",children:"Start a chat to see your history"})]}):(0,n.jsx)("div",{className:"space-y-2",children:a.map(e=>{var a;return(0,n.jsxs)("div",{className:(0,z.cn)("group flex items-center gap-2 p-2 rounded-lg border transition-colors hover:bg-muted/50 cursor-pointer",t===e.id&&"bg-muted border-primary"),onClick:()=>l(e),children:[(0,n.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,n.jsx)(A.A,{className:"h-3 w-3 text-muted-foreground shrink-0"}),(0,n.jsx)("span",{className:"text-xs text-muted-foreground",children:c(e.updatedAt)})]}),(0,n.jsx)("p",{className:"text-sm font-medium truncate",children:d(e)}),(0,n.jsxs)("p",{className:"text-xs text-muted-foreground",children:[(null==(a=e.messages)?void 0:a.length)||0," messages"]})]}),(0,n.jsxs)("div",{className:"flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[o&&(0,n.jsx)(w.$,{type:"button",variant:"ghost",size:"icon",className:"h-6 w-6",onClick:a=>{a.stopPropagation(),o(e)},children:(0,n.jsx)(X.A,{className:"h-3 w-3"})}),(0,n.jsx)(w.$,{type:"button",variant:"ghost",size:"icon",className:"h-6 w-6 text-destructive hover:text-destructive",onClick:a=>{a.stopPropagation(),r(e.id)},children:(0,n.jsx)(Y.A,{className:"h-3 w-3"})})]})]},e.id)})})})})]})}var ea=t(51778),et=t(24508),en=t(74711),el=t(76430);let er=new s.E({defaultOptions:{queries:{staleTime:3e5,gcTime:6e5,retry:1}}}),es={PROVIDER_CONFIG:"formedible-ai-builder-provider-config",CONVERSATIONS:"formedible-ai-builder-conversations",UI_STATE:"formedible-ai-builder-ui-state"};function eo(e){let{className:a,onFormGenerated:t,onFormSubmit:r}=e,[s,o]=(0,l.useState)(null),[i,c]=(0,l.useState)([]),[d,m]=(0,l.useState)(0),[u,p]=(0,l.useState)(!1),[h,g]=(0,l.useState)([]),[b,x]=(0,l.useState)(),[v,y]=(0,l.useState)([]),[j,N]=(0,l.useState)(!1);(0,l.useEffect)(()=>{try{let e=localStorage.getItem(es.PROVIDER_CONFIG);e&&o(JSON.parse(e));let a=localStorage.getItem(es.CONVERSATIONS),t=[];a&&(t=JSON.parse(a).map(e=>({...e,createdAt:new Date(e.createdAt),updatedAt:new Date(e.updatedAt)})),g(t));let n=localStorage.getItem(es.UI_STATE);if(n){let e=JSON.parse(n);if(N(e.isTopSectionCollapsed||!1),e.currentConversationId&&t.length>0){let a=t.find(a=>a.id===e.currentConversationId);if(a){x(e.currentConversationId),y(a.messages);let t=M(a.messages,a.id,new Date(a.updatedAt));c(t),m(0)}}}}catch(e){console.warn("Failed to load saved AI Builder data:",e)}},[]),(0,l.useEffect)(()=>{if(s)try{localStorage.setItem(es.PROVIDER_CONFIG,JSON.stringify(s))}catch(e){console.warn("Failed to save provider config:",e)}},[s]),(0,l.useEffect)(()=>{try{localStorage.setItem(es.CONVERSATIONS,JSON.stringify(h))}catch(e){console.warn("Failed to save conversations:",e)}},[h]),(0,l.useEffect)(()=>{try{localStorage.setItem(es.UI_STATE,JSON.stringify({isTopSectionCollapsed:j,currentConversationId:b}))}catch(e){console.warn("Failed to save UI state:",e)}},[j,b]);let w=(0,l.useCallback)(e=>{o(e)},[]),C=(0,l.useCallback)(e=>{let a={id:"form_".concat(Date.now()),code:e,timestamp:new Date};c(e=>{let t=[...e,a];return m(t.length-1),t}),null==t||t(e)},[t]),S=(0,l.useCallback)(e=>{p(e)},[]),A=(0,l.useCallback)(e=>{console.log("Form submitted:",e),null==r||r(e)},[r]),E=(0,l.useCallback)(e=>{m(e)},[]),k=(0,l.useCallback)(e=>{c(a=>{let t=a.filter((a,t)=>t!==e);return e<=d&&d>0?m(d-1):e<d||(0===t.length?m(0):d>=t.length&&m(t.length-1)),t})},[d]),I=(0,l.useCallback)(function(e){if(arguments.length>1&&void 0!==arguments[1]&&arguments[1],y(e),e.length>0)if(b)g(a=>a.map(a=>a.id===b?{...a,messages:e,updatedAt:new Date}:a));else{let a="conversation_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9));g(t=>t.some(e=>e.id===a)?t:[...t,{id:a,title:"",messages:e,createdAt:new Date,updatedAt:new Date}]),x(a)}},[b]),O=(0,l.useCallback)(()=>{x(void 0),y([]),c([]),m(0)},[]),T=(0,l.useCallback)(e=>{x(e.id),y(e.messages);let a=M(e.messages,e.id,new Date(e.updatedAt));console.log("Extracted forms from conversation:",a.length),c(a),m(0)},[]),L=(0,l.useCallback)(e=>{g(a=>a.filter(a=>a.id!==e)),b===e&&(x(void 0),y([]),c([]),m(0))},[b]),F=(0,l.useCallback)(e=>{let a="data:application/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(e,null,2)),t="conversation-".concat(e.id,".json"),n=document.createElement("a");n.setAttribute("href",a),n.setAttribute("download",t),n.click()},[]);return(0,n.jsxs)("div",{className:(0,z.cn)("flex flex-col h-full overflow-hidden",a),children:[(0,n.jsxs)("div",{className:"flex items-center gap-2 px-1 pb-1 flex-shrink-0",children:[(0,n.jsx)(ea.A,{className:"h-4 w-4 text-primary"}),(0,n.jsx)("h1",{className:"text-lg font-bold text-foreground",children:"AI Form Builder"})]}),(0,n.jsxs)("div",{className:"flex-shrink-0",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between mb-1 p-1.5 bg-accent/10 hover:bg-accent/20 rounded-lg border-2 border-accent/20 hover:border-accent/30 transition-all duration-200 shadow-sm cursor-pointer",onClick:()=>N(!j),children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("div",{className:"p-1 bg-accent/20 rounded-md",children:(0,n.jsx)(et.A,{className:"h-4 w-4 text-accent-foreground"})}),(0,n.jsx)("span",{className:"text-sm font-semibold text-foreground",children:"Settings & History"})]}),(0,n.jsx)("div",{className:"flex items-center gap-1 text-sm h-7 px-3",children:j?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(en.A,{className:"h-4 w-4"}),(0,n.jsx)("span",{className:"font-medium",children:"Show"})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(el.A,{className:"h-4 w-4"}),(0,n.jsx)("span",{className:"font-medium",children:"Hide"})]})})]}),!j&&(0,n.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-1.5",children:[(0,n.jsx)(ee,{conversations:h,currentConversationId:b,onSelectConversation:T,onDeleteConversation:L,onExportConversation:F}),(0,n.jsx)(f,{onConfigChange:w,initialConfig:s})]})]}),(0,n.jsxs)("div",{className:"flex-1 grid grid-cols-1 lg:grid-cols-2 gap-1.5 min-h-0 overflow-hidden",children:[(0,n.jsx)(q,{onFormGenerated:C,onStreamingStateChange:S,onConversationUpdate:I,onNewConversation:O,messages:v,providerConfig:s,className:"h-full overflow-hidden"}),(0,n.jsx)(W,{forms:i,currentFormIndex:d,onFormIndexChange:E,onDeleteForm:k,isStreaming:u,onFormSubmit:A,className:"h-full overflow-hidden"})]})]})}function ei(e){return(0,n.jsx)(o.Ht,{client:er,children:(0,n.jsx)(eo,{...e})})}function ec(){return(0,n.jsx)("div",{className:"h-[calc(100vh-4rem)] bg-background",children:(0,n.jsx)(r.P.div,{className:"h-full p-2",initial:{y:30,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2},children:(0,n.jsx)("div",{className:"bg-card border rounded-lg shadow-sm h-full p-2",children:(0,n.jsx)(ei,{className:"h-full w-full"})})})})}},24265:(e,a,t)=>{Promise.resolve().then(t.bind(t,23195))}},e=>{var a=a=>e(e.s=a);e.O(0,[803,46,531,375,800,826,609,624,318,587,315,358],()=>a(24265)),_N_E=e.O()}]);