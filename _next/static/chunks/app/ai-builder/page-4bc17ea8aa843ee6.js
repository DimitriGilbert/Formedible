(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[327],{24265:(e,t,a)=>{Promise.resolve().then(a.bind(a,82819))},82819:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>eC});var n=a(54568),r=a(7620),i=a(32545),s=a(78021),o=a(87606),l=a(40545),c=a(51874);let d=[{value:"openai",label:"OpenAI",requiresKey:!0},{value:"anthropic",label:"Anthropic",requiresKey:!0},{value:"google",label:"Google Gemini",requiresKey:!0},{value:"mistral",label:"Mistral",requiresKey:!0},{value:"openrouter",label:"OpenRouter",requiresKey:!0},{value:"openai-compatible",label:"OpenAI Compatible",requiresKey:!1}];function m(e){let{onConfigChange:t,initialConfig:a,className:r}=e,{Form:i}=(0,l.X)({fields:[{name:"provider",type:"select",label:"Provider",placeholder:"Select provider...",options:d.map(e=>({value:e.value,label:e.label}))},{name:"apiKey",type:"password",label:"API Key",placeholder:"Enter your API key...",description:"Your API key is stored securely and never sent to our servers"},{name:"endpoint",type:"text",label:"API Endpoint",placeholder:"https://api.example.com/v1",conditional:e=>"openai-compatible"===e.provider,description:"Base URL for OpenAI-compatible API"}],formOptions:{defaultValues:{provider:null==a?void 0:a.provider,apiKey:(null==a?void 0:a.apiKey)||"",endpoint:(null==a?void 0:a.endpoint)||""},onSubmit:async e=>{let{value:a}=e,n={provider:a.provider,apiKey:a.apiKey||"",...a.endpoint&&{endpoint:a.endpoint}};return["openai","anthropic","google","mistral","openrouter"].includes(n.provider)&&(!n.apiKey||0===n.apiKey.trim().length)?void c.oR.error("API key required",{description:"Please enter a valid API key for ".concat(n.provider,".")}):"openai-compatible"!==n.provider||n.endpoint&&0!==n.endpoint.trim().length?void(t(n),c.oR.success("Provider configured successfully!",{description:"You can now start building forms with AI."})):void c.oR.error("Endpoint required",{description:"Please enter a valid API endpoint for OpenAI-compatible provider."})}},submitLabel:"\uD83D\uDCBE Save Configuration",showSubmitButton:!0,autoSubmitOnChange:!1});return(0,n.jsxs)("div",{className:"p-4 space-y-4 ".concat(r||""),children:[(0,n.jsx)("h3",{className:"text-base font-semibold",children:"AI Provider"}),(0,n.jsx)(i,{})]})}var u=a(93928),p=a(58950),f=a(78514),g=a(89188),h=a(61038),b=a(56479),y=a(30142),x=a(34118),v=a(47227),N=a(17129),C=a(63353),w=a(83908),j=a(64529),S=a(60066),D=a(19594),k=a(49369),E=a(62501),A=a(39690),I=a(8024),P=a(43755);let O=(0,a(615).F)("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}});function F(e){let{className:t,variant:a,...r}=e;return(0,n.jsx)("div",{"data-slot":"alert",role:"alert",className:(0,u.cn)(O({variant:a}),t),...r})}function T(e){let{className:t,...a}=e;return(0,n.jsx)("div",{"data-slot":"alert-description",className:(0,u.cn)("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",t),...a})}var L=a(93204);function z(e){let t=e.match(/```formedible\s*\n([\s\S]*?)\n```/);return t&&t[1]?t[1].trim():null}function _(e,t,a){let n=[];return e.forEach((e,r)=>{if("assistant"===e.role&&e.content){let i=z(e.content);i&&n.push({id:t?"form_".concat(t,"_").concat(r):"form_".concat(Date.now(),"_").concat(r),code:i,timestamp:a||new Date})}}),n}let R={strictValidation:!0,enableSchemaInference:!1,mergeStrategy:"extend",fieldTypeValidation:!0,customInstructions:void 0,maxCodeLength:1e6,maxNestingDepth:50,enableZodParsing:!0,showDetailedErrors:!0,selectFields:!1,systemPromptFields:["text","email","url","textarea","number","select","multiSelect","radio","checkbox","switch","date","file","slider","rating","phone","colorPicker","password","duration","autocomplete","maskedInput","array","object"],includeTabFormatting:!0,includePageFormatting:!0},V={text:{name:"fullName",type:"text",label:"Full Name",required:!0},email:{name:"email",type:"email",label:"Email Address",required:!0},url:{name:"website",type:"url",label:"Website URL"},textarea:{name:"message",type:"textarea",label:"Message",textareaConfig:{rows:4,maxLength:500,showWordCount:!0}},number:{name:"age",type:"number",label:"Age",numberConfig:{min:18,max:120,allowNegative:!1}},select:{name:"country",type:"select",label:"Country",options:[{value:"us",label:"United States"},{value:"uk",label:"United Kingdom"},{value:"ca",label:"Canada"}]},multiSelect:{name:"skills",type:"multiSelect",label:"Skills",options:["React","Vue","Angular","Node.js"],multiSelectConfig:{maxSelections:3,searchable:!0,creatable:!0}},radio:{name:"plan",type:"radio",label:"Plan",options:[{value:"free",label:"Free Plan"},{value:"pro",label:"Pro Plan"},{value:"enterprise",label:"Enterprise Plan"}]},checkbox:{name:"newsletter",type:"checkbox",label:"Subscribe to Newsletter"},switch:{name:"notifications",type:"switch",label:"Enable Notifications"},date:{name:"birthDate",type:"date",label:"Birth Date",dateConfig:{format:"yyyy-MM-dd",showTime:!1}},file:{name:"resume",type:"file",label:"Resume",fileConfig:{accept:".pdf,.doc,.docx",maxSize:5e6,multiple:!1}},slider:{name:"experience",type:"slider",label:"Years Experience",sliderConfig:{min:0,max:20,step:1}},rating:{name:"satisfaction",type:"rating",label:"Satisfaction Rating",ratingConfig:{max:5,allowHalf:!0,icon:"star"}},phone:{name:"phone",type:"phone",label:"Phone Number",phoneConfig:{defaultCountry:"US",format:"national"}},colorPicker:{name:"brandColor",type:"colorPicker",label:"Brand Color",colorConfig:{format:"hex",presetColors:["#ff0000","#00ff00","#0000ff"],allowCustom:!0}},password:{name:"password",type:"password",label:"Password",passwordConfig:{showToggle:!0,strengthMeter:!0}},duration:{name:"workHours",type:"duration",label:"Work Hours",durationConfig:{format:"hm",showLabels:!0}},autocomplete:{name:"city",type:"autocomplete",label:"City",autocompleteConfig:{options:["New York","Los Angeles","Chicago","Houston"],minChars:2,allowCustom:!0}},maskedInput:{name:"ssn",type:"maskedInput",label:"SSN",maskedInputConfig:{mask:"000-00-0000",guide:!0}},array:{name:"team",type:"array",label:"Team Members",arrayConfig:{itemType:"object",itemLabel:"Team Member",minItems:1,maxItems:10,sortable:!0,addButtonLabel:"Add Member",removeButtonLabel:"Remove",objectConfig:{fields:[{name:"name",type:"text",label:"Full Name",required:!0},{name:"role",type:"select",label:"Role",options:["Developer","Designer","Manager"]},{name:"email",type:"email",label:"Email",required:!0}]}}},object:{name:"address",type:"object",label:"Address",objectConfig:{title:"Mailing Address",collapsible:!0,layout:"vertical",fields:[{name:"street",type:"text",label:"Street Address",required:!0},{name:"city",type:"text",label:"City",required:!0},{name:"state",type:"select",label:"State",options:["CA","NY","TX","FL"]},{name:"zip",type:"text",label:"ZIP Code",required:!0}]}}},q=[{name:"strictValidation",type:"switch",label:"Strict Validation",description:"Enable strict validation of form definitions. When enabled, unknown properties are rejected.",defaultValue:!0},{name:"enableSchemaInference",type:"switch",label:"Schema Inference",description:"Automatically infer Zod schemas from field definitions to provide better type safety.",defaultValue:!1},{name:"mergeStrategy",type:"select",label:"Schema Merge Strategy",description:"How to merge parsed configurations with base schemas.",defaultValue:"extend",options:[{value:"extend",label:"Extend - Add missing fields from base schema"},{value:"override",label:"Override - Replace schema completely"},{value:"intersect",label:"Intersect - Keep only common fields"}]},{name:"fieldTypeValidation",type:"switch",label:"Field Type Validation",description:"Validate field types against the list of supported field types.",defaultValue:!0},{name:"customInstructions",type:"textarea",label:"Custom Instructions",description:"Optional custom parsing instructions or constraints to apply.",placeholder:"Enter any custom parsing rules or requirements...",required:!1},{name:"maxCodeLength",type:"number",label:"Maximum Code Length",description:"Maximum allowed length for form definition code (in characters).",defaultValue:1e6,min:1e3,max:1e7,step:1e3},{name:"maxNestingDepth",type:"number",label:"Maximum Nesting Depth",description:"Maximum allowed nesting depth for object and array structures.",defaultValue:50,min:5,max:200,step:5},{name:"enableZodParsing",type:"switch",label:"Zod Expression Parsing",description:"Enable parsing and handling of Zod schema expressions in form definitions.",defaultValue:!0},{name:"showDetailedErrors",type:"switch",label:"Detailed Error Information",description:"Include detailed error context and location information in parser output.",defaultValue:!0},{name:"selectFields",type:"switch",label:"Select Fields",defaultValue:!1},{name:"systemPromptFields",type:"multiSelect",label:"Field Types",description:"Select which formedible field types to include as examples in the system prompt.",options:Object.keys(V).map(e=>({value:e,label:e.charAt(0).toUpperCase()+e.slice(1)})),defaultValue:Object.keys(V)},{name:"includeTabFormatting",type:"switch",label:"Tab Formatting",description:"Include tab-based form structure in the system prompt.",defaultValue:!0},{name:"includePageFormatting",type:"switch",label:"Page Formatting",description:"Include multi-page form structure in the system prompt.",defaultValue:!0}];function M(e){let t=Object.entries({strictValidation:e.strictValidation?"Use strict validation - reject unknown properties and enforce schema compliance":"Use permissive validation - allow unknown properties and be flexible with schema",fieldTypeValidation:e.fieldTypeValidation?"Validate all field types against the 24 supported formedible field types":"Allow flexible field types without strict validation",enableSchemaInference:e.enableSchemaInference?"Automatically infer Zod schemas from field definitions for better type safety":"Use manual schema definition without automatic inference",mergeStrategy:'Use "'.concat(e.mergeStrategy,'" strategy when merging schemas - ').concat("extend"===e.mergeStrategy?"add missing fields from base schema":"override"===e.mergeStrategy?"replace schema completely":"keep only fields that exist in both schemas"),maxCodeLength:"Maximum allowed form definition length: ".concat(e.maxCodeLength.toLocaleString()," characters"),maxNestingDepth:"Maximum nesting depth for object and array structures: ".concat(e.maxNestingDepth," levels"),enableZodParsing:e.enableZodParsing?"Parse and handle Zod schema expressions (z.string(), z.number(), etc.)":"Treat Zod expressions as plain text without parsing",showDetailedErrors:e.showDetailedErrors?"Include detailed error context, location information, and debugging details":"Provide minimal error information",...e.customInstructions?{customInstructions:"Additional instructions: ".concat(e.customInstructions)}:{}}).filter(e=>{let[t,a]=e;return!!a}).map(e=>{let[t,a]=e;return a});if(!t.length&&!e.includeTabFormatting&&!e.includePageFormatting)return"";let a="# Formedible Parser Configuration\n\nYou are working with a Formedible form parser that has been configured with the following settings:\n\n".concat(t.map((e,t)=>"".concat(t+1,". ").concat(e)).join("\n"),"\n\n## Key Guidelines\n- Follow the configured validation and parsing rules strictly\n- Generate forms that respect the maximum limits and nesting depth\n- Use the specified error message style and detail level\n- Apply the configured schema inference and merging strategies\n\n## CRITICAL: Formedible Library Compliance\n- Generate CONFIGURATION OBJECTS for formedible, NOT executable code\n- Use this format: { fields: [...], formOptions: { defaultValues: {...} }, ... }\n- DO NOT include function implementations in onSubmit - use placeholder comments\n- DO NOT include validation strings like \"z.string()\" - validation is handled by the schema\n- DO NOT use 'condition' property - conditional fields are not supported in parser mode\n- DO NOT use string schemas like 'schema: \"z.object(...)\"' - omit schema property or use actual Zod objects  \n- Use proper field config properties: min/max directly on fields, not in config objects for basic types\n- AVOID conditional fields entirely - parser cannot handle function strings in JSON format\n- For object fields, use proper objectConfig with nested fields array\n- Respect UseFormedibleOptions interface: title, description, fields, formOptions, submitLabel, etc.");(e.includeTabFormatting||e.includePageFormatting)&&(a+="\n\n## Form Structure Guidelines",e.includeTabFormatting&&(a+="\n- **Tab Layout**: Use the `layout: { type: 'tabs' }` configuration for organizing forms into logical sections\n- **Tab Structure**: Each tab should group related fields together for better user experience\n- **Tab Navigation**: Ensure tab titles are descriptive and help users understand the content"),e.includePageFormatting&&(a+="\n- **Multi-Page Forms**: Use the `pages` array to create multi-step forms for complex data collection\n- **Page Structure**: Each page should have a clear purpose and logical flow\n- **Page Navigation**: Include appropriate navigation controls with `nextLabel`, `previousLabel`, and `submitLabel`\n- **Progress Indication**: Consider adding progress indicators for multi-page forms using the `progress` configuration"));let n={title:"User Registration Form",description:"Complete user registration with validation",fields:[{name:"fullName",type:"text",label:"Full Name",placeholder:"Enter your full name",required:!0},{name:"email",type:"email",label:"Email Address",placeholder:"your@email.com",required:!0},{name:"password",type:"password",label:"Password",required:!0,passwordConfig:{showToggle:!0,strengthMeter:!0}},{name:"age",type:"number",label:"Age",required:!0,min:18,max:120},{name:"country",type:"select",label:"Country",required:!0,options:[{value:"us",label:"United States"},{value:"uk",label:"United Kingdom"},{value:"ca",label:"Canada"},{value:"au",label:"Australia"}]},{name:"newsletter",type:"checkbox",label:"Subscribe to Newsletter",description:"Receive updates about new features and promotions"}],formOptions:{defaultValues:{fullName:"",email:"",password:"",age:18,country:"",newsletter:!1}},submitLabel:"Create Account",layout:{type:"grid",columns:2,gap:"md"}};e.includeTabFormatting&&e.includePageFormatting?n={title:"Complete Profile Setup",description:"Multi-step registration with organized sections",layout:{type:"stepper"},pages:[{title:"Personal Information",description:"Basic details about you"},{title:"Account Preferences",description:"Customize your experience"},{title:"Review & Submit",description:"Confirm your information"}],tabs:[{id:"basic",label:"Basic Info",description:"Name and contact"},{id:"address",label:"Address",description:"Location details"},{id:"settings",label:"Settings",description:"Account preferences"}],fields:[{name:"firstName",type:"text",label:"First Name",required:!0,page:1,tab:"basic"},{name:"lastName",type:"text",label:"Last Name",required:!0,page:1,tab:"basic"},{name:"email",type:"email",label:"Email",required:!0,page:1,tab:"basic"},{name:"address",type:"object",label:"Address",page:1,tab:"address",objectConfig:{title:"Mailing Address",fields:[{name:"street",type:"text",label:"Street Address",required:!0},{name:"city",type:"text",label:"City",required:!0},{name:"zipCode",type:"text",label:"ZIP Code",required:!0}]}},{name:"notifications",type:"switch",label:"Email Notifications",page:2,tab:"settings"},{name:"theme",type:"select",label:"Preferred Theme",page:2,tab:"settings",options:[{value:"light",label:"Light"},{value:"dark",label:"Dark"},{value:"auto",label:"Auto"}]}],schema:"z.object({ firstName: z.string().min(1), lastName: z.string().min(1), email: z.string().email(), address: z.object({ street: z.string(), city: z.string(), zipCode: z.string() }), notifications: z.boolean().optional(), theme: z.enum(['light', 'dark', 'auto']).optional() })",formOptions:{defaultValues:{firstName:"",lastName:"",email:"",address:{street:"",city:"",zipCode:""},notifications:!0,theme:"auto"}},nextLabel:"Continue",previousLabel:"Back",submitLabel:"Complete Setup"}:e.includeTabFormatting?n={title:"Project Application Form",description:"Comprehensive application with tabbed organization",layout:{type:"tabs"},tabs:[{id:"personal",label:"Personal Info",description:"Your basic information"},{id:"project",label:"Project Details",description:"About your project"},{id:"experience",label:"Experience",description:"Your background"}],fields:[{name:"fullName",type:"text",label:"Full Name",required:!0,tab:"personal"},{name:"email",type:"email",label:"Email Address",required:!0,tab:"personal"},{name:"phone",type:"phone",label:"Phone Number",tab:"personal",phoneConfig:{defaultCountry:"US",format:"national"}},{name:"projectTitle",type:"text",label:"Project Title",required:!0,tab:"project"},{name:"projectDescription",type:"textarea",label:"Project Description",required:!0,tab:"project",textareaConfig:{rows:6,maxLength:1e3,showWordCount:!0}},{name:"budget",type:"select",label:"Budget Range",required:!0,tab:"project",options:[{value:"under-5k",label:"Under $5,000"},{value:"5k-15k",label:"$5,000 - $15,000"},{value:"15k-50k",label:"$15,000 - $50,000"},{value:"over-50k",label:"Over $50,000"}]},{name:"yearsExperience",type:"slider",label:"Years of Experience",tab:"experience",sliderConfig:{min:0,max:30,step:1}},{name:"skills",type:"multiSelect",label:"Skills",tab:"experience",options:["JavaScript","TypeScript","React","Node.js","Python","Design"],multiSelectConfig:{maxSelections:5,searchable:!0}}],schema:"z.object({ fullName: z.string().min(2), email: z.string().email(), phone: z.string().optional(), projectTitle: z.string().min(5), projectDescription: z.string().min(50), budget: z.enum(['under-5k', '5k-15k', '15k-50k', 'over-50k']), yearsExperience: z.number().min(0).max(30).optional(), skills: z.array(z.string()).optional() })",formOptions:{defaultValues:{fullName:"",email:"",phone:"",projectTitle:"",projectDescription:"",budget:"",yearsExperience:0,skills:[]}},submitLabel:"Submit Application"}:e.includePageFormatting&&(n={title:"Customer Onboarding",description:"Complete your account setup in simple steps",layout:{type:"stepper"},pages:[{title:"Account Details",description:"Create your account credentials"},{title:"Personal Information",description:"Tell us about yourself"},{title:"Preferences",description:"Customize your experience"},{title:"Confirmation",description:"Review and confirm your information"}],fields:[{name:"username",type:"text",label:"Username",required:!0,page:1,placeholder:"Choose a unique username"},{name:"email",type:"email",label:"Email Address",required:!0,page:1},{name:"password",type:"password",label:"Password",required:!0,page:1,passwordConfig:{showToggle:!0,strengthMeter:!0}},{name:"firstName",type:"text",label:"First Name",required:!0,page:2},{name:"lastName",type:"text",label:"Last Name",required:!0,page:2},{name:"birthDate",type:"date",label:"Date of Birth",page:2,dateConfig:{format:"yyyy-MM-dd",showTime:!1}},{name:"company",type:"text",label:"Company (Optional)",page:2},{name:"notifications",type:"switch",label:"Email Notifications",description:"Receive product updates and newsletters",page:3},{name:"language",type:"select",label:"Preferred Language",page:3,options:[{value:"en",label:"English"},{value:"es",label:"Spanish"},{value:"fr",label:"French"},{value:"de",label:"German"}]},{name:"interests",type:"multiSelect",label:"Interests",page:3,options:["Technology","Design","Marketing","Sales","Finance","Education"],multiSelectConfig:{maxSelections:3,searchable:!0}}],schema:"z.object({ username: z.string().min(3), email: z.string().email(), password: z.string().min(8), firstName: z.string().min(1), lastName: z.string().min(1), birthDate: z.date().optional(), company: z.string().optional(), notifications: z.boolean().optional(), language: z.enum(['en', 'es', 'fr', 'de']).optional(), interests: z.array(z.string()).optional() })",formOptions:{defaultValues:{username:"",email:"",password:"",firstName:"",lastName:"",birthDate:void 0,company:"",notifications:!0,language:"en",interests:[]}},nextLabel:"Continue",previousLabel:"Back",submitLabel:"Complete Setup",progress:{showProgress:!0,showStepNumbers:!0}});let r=Object.entries(V).filter(t=>{let[a]=t;return e.systemPromptFields.includes(a)});return r.length>0?a+="\n\n## Field Examples\n\nEach field type has a complete example configuration:\n\n### Available Field Types (Selected: ".concat(e.systemPromptFields.join(", "),")\n").concat(r.map(e=>{let[t,a]=e;return"**".concat(t,"**: `").concat(JSON.stringify(a,null,2),"`")}).join("\n\n")):a+="\n\n## Field Examples\n\nNo specific field types selected. Use the default formedible field types as needed.",a+="\n\n## Complete Form Example\n\nBased on your current configuration:\n\n```json\n".concat(JSON.stringify(n,null,2),"\n```\n\nWhen generating forms, use these field examples and adapt the structure based on the configuration options above.")}function B(e){let t,{content:a}=e,r=/```(\w+)?\s*\n([\s\S]*?)\n```/g,i=[],s=0;for(;null!==(t=r.exec(a));){t.index>s&&i.push((0,n.jsx)("span",{className:"whitespace-pre-wrap break-words leading-relaxed",children:a.slice(s,t.index)},"text-".concat(s)));let e=t[1]||"text",r=t[2];i.push((0,n.jsx)("div",{className:"my-2",children:(0,n.jsx)(L.N,{code:r,language:e,showLineNumbers:!1,showCopyButton:!0,className:"text-xs",darkMode:!0,scrollable:!1})},"code-".concat(t.index))),s=t.index+t[0].length}return s<a.length&&i.push((0,n.jsx)("span",{className:"whitespace-pre-wrap break-words leading-relaxed",children:a.slice(s)},"text-".concat(s))),(0,n.jsx)("div",{className:"space-y-1",children:i.length>0?i:(0,n.jsx)("span",{className:"whitespace-pre-wrap break-words leading-relaxed",children:a})})}function U(e){let{onFormGenerated:t,onStreamingStateChange:a,onConversationUpdate:i,onNewConversation:s,messages:o,className:l,providerConfig:d,mode:m="direct",backendConfig:O}=e,[L,_]=(0,r.useState)(""),[V,q]=(0,r.useState)(o||[]),[U,Z]=(0,r.useState)(!1),[G,J]=(0,r.useState)(null),[K,H]=(0,r.useState)(!1),$=(0,r.useRef)(null),Y=(0,r.useRef)(null),W=(0,r.useCallback)(()=>{let e=$.current;e&&(e.scrollTop=e.scrollHeight)},[]),X=(0,r.useCallback)(()=>{if(!$.current)return;let{scrollTop:e,scrollHeight:t,clientHeight:a}=$.current;H(!(t-e-a<100)&&V.length>0)},[V.length]);(0,r.useEffect)(()=>{void 0!==o&&q(o)},[o]),(0,r.useEffect)(()=>{let e=$.current;if(e)return e.addEventListener("scroll",X),X(),()=>e.removeEventListener("scroll",X)},[X]);let Q=e=>{let{provider:t,apiKey:a,model:n,endpoint:r}=e;switch(t){case"openai":return(0,f.r)({apiKey:a})(n||"gpt-5");case"anthropic":return(0,g.n)({apiKey:a})(n||"claude-sonnet-4");case"google":return(0,h.s)({apiKey:a})(n||"gemini-2.5-pro");case"mistral":return(0,b.T)({apiKey:a})(n||"mistral-large-2407");case"openrouter":return(0,y.ER)({apiKey:a}).chat(n||"openrouter/kimiplus-k2");case"openai-compatible":if(!r)throw Error("Endpoint required for OpenAI-compatible providers");return(0,x.jr)({name:"openai-compatible",baseURL:r,...a&&{apiKey:a}})(n||"gpt-4.1-mini");default:throw Error("Unsupported provider")}},ee=()=>"backend"===m?!!(O&&O.endpoint&&O.endpoint.trim().length>0):!!d&&(["openai","anthropic","google","mistral","openrouter"].includes(d.provider)?!!(d.apiKey&&d.apiKey.trim().length>0):"openai-compatible"!==d.provider||!!(d.endpoint&&d.endpoint.trim().length>0)),et=async(e,t,a,n)=>{if("backend"===m){if(!(null==O?void 0:O.endpoint))throw Error("Backend endpoint not configured");let r=await fetch(O.endpoint,{method:"POST",headers:{"Content-Type":"application/json",...O.headers},body:JSON.stringify({messages:t.map(e=>({role:e.role,content:e.content})),systemPrompt:a,userMessage:e}),signal:n});if(!r.ok)throw Error("Backend request failed: ".concat(r.status," ").concat(r.statusText));if(!r.body)throw Error("No response body from backend");return{async *[Symbol.asyncIterator](){let e=r.body.getReader(),t=new TextDecoder;try{for(;;){let{done:a,value:n}=await e.read();if(a)break;let r=t.decode(n,{stream:!0});yield r}}finally{e.releaseLock()}}}}{if(!d)throw Error("Provider configuration required");let e=Q(d);return(0,p.gM)({model:e,system:a,messages:t.map(e=>({role:e.role,content:e.content})),temperature:d.temperature||.7,maxOutputTokens:d.maxTokens||2e3,abortSignal:n}).textStream}},ea=async e=>{if(!ee()){c.oR.error("backend"===m?"Backend not configured":"Provider not configured",{description:"backend"===m?"Backend endpoint configuration is required to send messages.":"Please configure your AI provider with a valid API key before sending messages."}),J(Error("Service configuration required"));return}try{Z(!0),J(null),null==a||a(!0);let n={id:Date.now().toString(),role:"user",content:e},r=[...V,n];q(r);let s=R;try{let e=localStorage.getItem("formedible-parser-config");if(e){let t=JSON.parse(e);s={...R,...t}}}catch(e){console.warn("Failed to load parser config, using defaults:",e)}let o=M(s),l="You are a helpful AI assistant for form creation. You can chat naturally with users about forms, answer questions, and help them design forms.\n\n**IMPORTANT: Only show formedible code blocks when the user specifically asks to create, build, generate, or show a form.**\n\nWhen creating forms, use formedible code blocks with complete JavaScript object literal syntax including Zod schemas. Chat naturally. Ask clarifying questions. Suggest improvements. Only output formedible blocks when specifically requested.",c=o?"".concat(l,"\n\n").concat(o):l,d=new AbortController;Y.current=d;let m=await et(e,[...V,n],c,d.signal),u={id:(Date.now()+1).toString(),role:"assistant",content:""};q(e=>[...e,u]);let p="";for await(let e of m){if(d.signal.aborted)break;p+=e,q(e=>e.map(e=>e.id===u.id?{...e,content:p}:e))}if(p&&t){let e=z(p);e&&t(e)}null==a||a(!1);let f=[...r,{...u,content:p}];null==i||i(f,!0)}catch(e){console.error("AI Generation Error:",e),J(e instanceof Error?e:Error("Unknown error occurred"))}finally{Z(!1),null==a||a(!1),Y.current=null}},en=e=>{if(e.preventDefault(),L.trim()&&!U){if(!ee())return void c.oR.error("backend"===m?"Backend configuration required":"Provider configuration required",{description:"backend"===m?"Backend endpoint configuration is required to send messages.":"Please set up your AI provider with a valid API key in the settings before sending messages."});_(""),ea(L)}};return(0,n.jsxs)(C.Zp,{className:(0,u.cn)("flex flex-col h-full max-h-full border-2 border-accent/30 shadow-lg !py-0 !gap-0 overflow-hidden",l),children:[(0,n.jsx)(C.aR,{className:"px-3 pt-1 pb-0 bg-gradient-to-r from-accent/10 to-transparent",children:(0,n.jsxs)(C.ZB,{className:"flex items-center justify-between text-lg",children:[(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[(0,n.jsx)("div",{className:"p-2 bg-accent/20 rounded-lg",children:(0,n.jsx)(w.A,{className:"h-5 w-5 text-accent-foreground"})}),(0,n.jsx)("span",{className:"text-foreground font-semibold",children:"AI Form Builder Chat"})]}),s&&(0,n.jsxs)(v.$,{variant:"outline",size:"sm",onClick:s,className:"h-8 w-8 p-0",children:[(0,n.jsx)(j.A,{className:"h-4 w-4"}),(0,n.jsx)("span",{className:"sr-only",children:"New conversation"})]})]})}),(0,n.jsxs)(C.Wu,{className:"flex flex-col flex-1 px-3 pt-0 pb-1 min-h-0 max-h-full relative overflow-hidden",children:[(0,n.jsxs)("div",{ref:$,className:"flex-1 overflow-y-auto space-y-3 mb-1 pr-2 min-h-0",children:[0===V.length&&(0,n.jsxs)("div",{className:"flex flex-col items-center justify-center h-full text-center text-muted-foreground",children:[(0,n.jsx)(S.A,{className:"h-12 w-12 mb-4 opacity-50"}),(0,n.jsx)("h3",{className:"text-lg font-medium mb-2",children:"Welcome to AI Form Builder"}),(0,n.jsx)("p",{className:"text-sm max-w-md",children:'Describe the form you want to create and I\'ll generate it for you. Try something like "Create a contact form with name, email, and message fields"'})]}),V.map(e=>(0,n.jsxs)("div",{className:(0,u.cn)("flex gap-3 max-w-4xl","user"===e.role?"ml-auto flex-row-reverse":"mr-auto"),children:[(0,n.jsx)("div",{className:(0,u.cn)("flex h-8 w-8 shrink-0 select-none items-center justify-center rounded-full border-2 shadow-md","user"===e.role?"bg-primary text-primary-foreground border-primary/30":"bg-muted text-foreground border-border"),children:"user"===e.role?(0,n.jsx)(D.A,{className:"h-4 w-4"}):(0,n.jsx)(S.A,{className:"h-4 w-4"})}),(0,n.jsx)("div",{className:(0,u.cn)("flex flex-col gap-2 rounded-lg px-4 py-3 text-sm shadow-md border max-w-[85%]","user"===e.role?"bg-primary text-primary-foreground border-primary/30":"bg-background text-foreground border-border"),children:(0,n.jsx)(B,{content:e.content})})]},e.id)),U&&(0,n.jsxs)("div",{className:"flex gap-3 max-w-4xl mr-auto",children:[(0,n.jsx)("div",{className:"flex h-8 w-8 shrink-0 select-none items-center justify-center rounded-full border-2 shadow-md bg-muted text-foreground border-border",children:(0,n.jsx)(S.A,{className:"h-4 w-4"})}),(0,n.jsxs)("div",{className:"flex items-center gap-2 rounded-lg px-4 py-3 text-sm shadow-md border bg-background text-foreground border-border",children:[(0,n.jsx)(k.A,{className:"h-4 w-4 animate-spin text-primary"}),(0,n.jsx)("span",{children:"Generating response..."})]})]})]}),K&&(0,n.jsxs)(v.$,{onClick:W,className:"absolute bottom-20 right-4 rounded-full w-10 h-10 p-0 shadow-lg z-10",variant:"secondary",size:"sm",children:[(0,n.jsx)(E.A,{className:"h-4 w-4"}),(0,n.jsx)("span",{className:"sr-only",children:"Scroll to bottom"})]}),G&&(0,n.jsxs)(F,{variant:"destructive",className:"mb-4",children:[(0,n.jsx)(A.A,{className:"h-4 w-4"}),(0,n.jsx)(T,{children:"Failed to send message. Please check your configuration and try again."})]}),(0,n.jsxs)("form",{onSubmit:en,className:"flex gap-2",children:[(0,n.jsx)(N.T,{value:L,onChange:e=>_(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),en(e))},placeholder:"Describe the form you want to create... (Shift+Enter for new line)",disabled:U,className:"flex-1 min-h-[80px] resize-none",rows:3}),U?(0,n.jsxs)(v.$,{type:"button",variant:"outline",size:"icon",onClick:()=>{Y.current&&(Y.current.abort(),Z(!1))},className:"shrink-0",children:[(0,n.jsx)(I.A,{className:"h-4 w-4"}),(0,n.jsx)("span",{className:"sr-only",children:"Stop generation"})]}):(0,n.jsxs)(v.$,{type:"submit",disabled:!L.trim()||!ee(),size:"icon",className:"shrink-0",children:[(0,n.jsx)(P.A,{className:"h-4 w-4"}),(0,n.jsx)("span",{className:"sr-only",children:"Send message"})]})]})]})]})}function Z(e){let{onFormGenerated:t,onStreamingStateChange:a,onConversationUpdate:r,onNewConversation:i,messages:s,className:o,providerConfig:l,mode:c,backendConfig:d}=e;return(0,n.jsx)(U,{onFormGenerated:t,onStreamingStateChange:a,onConversationUpdate:r,onNewConversation:i,messages:s,providerConfig:l,mode:c,backendConfig:d,className:(0,u.cn)("h-full",o)})}var G=a(80318);class J{static parse(e,t){if(!e||"string"!=typeof e)throw this.createParserError("Input code must be a non-empty string","INVALID_INPUT");if(e.length>this.CONFIG.MAX_CODE_LENGTH)throw this.createParserError("Code length exceeds maximum allowed size of ".concat(this.CONFIG.MAX_CODE_LENGTH," characters"),"CODE_TOO_LARGE");try{(null==t?void 0:t.strictValidation)!==void 0&&(this.CONFIG.ENABLE_STRICT_VALIDATION=t.strictValidation);let a=this.sanitizeCode(e),n=this.parseObjectLiteral(a);return this.validateAndSanitize(n)}catch(t){if(t instanceof Error&&"ParserError"===t.name)throw t;let e=t instanceof Error?t.message:String(t);throw this.createParserError("Failed to parse form definition. ".concat(e),"PARSE_ERROR",{originalError:t})}}static isValidFieldType(e){return this.ALLOWED_FIELD_TYPES.includes(e)}static getSupportedFieldTypes(){return[...this.ALLOWED_FIELD_TYPES]}static validateConfig(e){try{return this.validateAndSanitize(e),{isValid:!0,errors:[]}}catch(e){return{isValid:!1,errors:[e instanceof Error?e.message:String(e)]}}}static createParserError(e,t,a){let n=e;switch(t){case"INVALID_INPUT":n="❌ Invalid Input: ".concat(e,'\n\n\uD83D\uDD27 How to fix:\n• Provide a non-empty string containing your form definition\n• Make sure you\'re passing the form code as a string, not an object\n\n\uD83D\uDCDD Example:\nconst formCode = `{\n  fields: [\n    { name: "email", type: "email", label: "Email Address" }\n  ]\n}`;\nconst parsed = FormedibleParser.parse(formCode);');break;case"CODE_TOO_LARGE":n="❌ Code Too Large: ".concat(e,"\n\n\uD83D\uDD27 How to fix:\n• Reduce the size of your form definition\n• Split large forms into multiple smaller forms\n• Remove unnecessary comments or whitespace\n\n\uD83D\uDCA1 Tips:\n• Consider using arrays for repetitive field configurations\n• Use object field types to group related fields");break;case"SYNTAX_ERROR":n="❌ Syntax Error: ".concat(e,'\n\n\uD83D\uDD27 Common fixes:\n• Use double quotes around object keys: { "name": "value" }\n• Remove trailing commas: [item1, item2] not [item1, item2,]\n• Check for balanced brackets and parentheses\n• Escape quotes in strings: "It\'s working" → "It\\\'s working"\n\n\uD83D\uDCDD Valid formats:\nJSON: { "fields": [{ "name": "email", "type": "email" }] }\nJS Object: { fields: [{ name: "email", type: "email" }] }');break;case"INVALID_DEFINITION":n="❌ Invalid Definition: ".concat(e,'\n\n\uD83D\uDD27 How to fix:\n• Ensure your form definition is a JavaScript object or valid JSON\n• Must contain at least a \'fields\' array\n\n\uD83D\uDCDD Minimum required structure:\n{\n  fields: [\n    { name: "fieldName", type: "text" }\n  ]\n}');break;case"INVALID_FIELDS":n="❌ Invalid Fields: ".concat(e,'\n\n\uD83D\uDD27 How to fix:\n• The \'fields\' property must be an array\n• Each field must be an object with \'name\' and \'type\' properties\n\n\uD83D\uDCDD Example:\n{\n  fields: [\n    { name: "firstName", type: "text", label: "First Name" },\n    { name: "email", type: "email", label: "Email Address" }\n  ]\n}');break;case"INVALID_FIELD":let r=null==a?void 0:a.fieldIndex;n="❌ Invalid Field".concat(void 0!==r?" at position ".concat(r):"",": ").concat(e,"\n\n\uD83D\uDD27 How to fix:\n• Each field must be an object, not a string or number\n• Check that field #").concat(r||0,' is properly formatted\n\n\uD83D\uDCDD Field structure:\n{\n  name: "fieldName",     // Required: unique field identifier\n  type: "text",          // Required: field type\n  label: "Display Name", // Optional: user-friendly label\n  required: true         // Optional: validation\n}');break;case"MISSING_REQUIRED_FIELD":let i=null==a?void 0:a.fieldIndex;n="❌ Missing Required Properties".concat(void 0!==i?" in field #".concat(i):"",": ").concat(e,"\n\n\uD83D\uDD27 How to fix:\n• Every field MUST have both 'name' and 'type' properties\n• The 'name' should be a unique identifier for the field\n• The 'type' should be one of the supported field types\n\n\uD83D\uDCDD Fix field #").concat(i||0,':\n{\n  name: "uniqueFieldName",  // ✅ Required\n  type: "text",             // ✅ Required  \n  label: "Display Label"    // ✅ Recommended\n}');break;case"UNSUPPORTED_FIELD_TYPE":let s=null==a?void 0:a.fieldType,o=this.ALLOWED_FIELD_TYPES.join(", ");n="❌ Unsupported Field Type: ".concat(e,'\n\n\uD83D\uDD27 How to fix:\n• Change field type from "').concat(s,'" to one of the supported types\n• Check for typos in the field type name\n\n✅ Supported field types:\n').concat(o,'\n\n\uD83D\uDCDD Common field types:\n• "text" - Single line text input\n• "email" - Email address with validation  \n• "number" - Numeric input with validation\n• "select" - Dropdown selection\n• "checkbox" - Boolean checkbox\n• "date" - Date picker\n• "textarea" - Multi-line text area');break;case"INVALID_ARRAY_CONFIG":n="❌ Invalid Array Configuration: ".concat(e,'\n\n\uD83D\uDD27 How to fix:\n• Array field configuration must be an object\n• Provide arrayConfig with proper structure\n\n\uD83D\uDCDD Example array field:\n{\n  name: "items",\n  type: "array",\n  arrayConfig: {\n    itemType: "text",           // Type of each array item\n    itemLabel: "Item",          // Label for each item\n    minItems: 1,               // Minimum number of items\n    maxItems: 10,              // Maximum number of items\n    addButtonLabel: "Add Item" // Custom add button text\n  }\n}');break;case"INVALID_OBJECT_CONFIG":n="❌ Invalid Object Configuration: ".concat(e,'\n\n\uD83D\uDD27 How to fix:\n• Object field configuration must be an object\n• Provide objectConfig with fields array\n\n\uD83D\uDCDD Example object field:\n{\n  name: "address",\n  type: "object",\n  objectConfig: {\n    title: "Address Information",\n    fields: [\n      { name: "street", type: "text", label: "Street" },\n      { name: "city", type: "text", label: "City" }\n    ]\n  }\n}');break;case"PARSE_ERROR":n="❌ Parsing Failed: ".concat(e,'\n\n\uD83D\uDD27 Common causes and fixes:\n• **Syntax Issues**: Check for missing quotes, brackets, or commas\n• **Invalid JavaScript**: Ensure object literal syntax is correct\n• **Zod Expressions**: Make sure Zod schemas are properly formatted\n\n\uD83D\uDCDD Debugging steps:\n1. Validate your JSON syntax using an online JSON validator\n2. Check that all object keys are quoted: { "name": "value" }\n3. Remove trailing commas: [item1, item2] not [item1, item2,]\n4. Verify Zod expressions: z.string().min(1) not z.string.min(1)\n\n\uD83D\uDCA1 Example working format:\n{\n  fields: [\n    {\n      name: "email",\n      type: "email", \n      label: "Email Address",\n      validation: "z.string().email()"\n    }\n  ],\n  schema: "z.object({ email: z.string().email() })"\n}');break;default:n="❌ Parser Error: ".concat(e,"\n\n\uD83D\uDD27 General troubleshooting:\n• Check JSON/JavaScript syntax\n• Verify all required properties are present\n• Ensure field types are supported\n• Check for typos in property names\n\n\uD83D\uDCA1 Need help? Provide the exact form code that's causing issues for specific assistance.")}let l=Error(n);return l.name="ParserError",l.code=t,a&&Object.assign(l,a),l}static sanitizeCode(e){let t=e.replace(/\/\*[\s\S]*?\*\//g,"").replace(/\/\/.*$/gm,"");return[/\b(eval|Function|setTimeout|setInterval|require|import)\s*\(/g,/\b(document|window|global|process)\b/g,/\b__proto__\b/g,/\bconstructor\b/g,/\bprototype\b/g].forEach(e=>{t=t.replace(e,'""')}),t=(t=(t=(t=(t=t.replace(/=>\s*[\{]?[^}]*[\}]?/g,'""')).replace(/function\s*\([^)]*\)\s*{[^}]*}/g,'""')).replace(/new\s+Date\(\)\.toISOString\(\)\.split\('[^']*'\)\[0\]/g,'"2024-01-01"')).replace(/new\s+Date\(\)/g,'"2024-01-01T00:00:00Z"')).replace(/\bnew\s+\w+\(/g,'""')}static parseObjectLiteral(e){try{return JSON.parse(e)}catch(a){let t=e.trim();try{return t=(t=(t=(t=(t=this.replaceZodExpressions(t)).replace(/([{,]\s*)([a-zA-Z_$][a-zA-Z0-9_$]*)\s*:/g,'$1"$2":')).replace(/,(\s*[}\]])/g,"$1")).replace(RegExp("(?<!\\\\)'","g"),'"')).replace(/:\s*undefined/g,": null"),JSON.parse(t)}catch(i){let n=e.substring(0,200)+(e.length>200?"...":""),r=t.substring(0,200)+(t.length>200?"...":"");throw this.createParserError("Invalid syntax. Please use valid JSON format or JavaScript object literal syntax.","SYNTAX_ERROR",{originalCode:n,processedCode:r,jsonError:a instanceof Error?a.message:String(a),conversionError:i instanceof Error?i.message:String(i)})}}}static replaceZodExpressions(e){let t=e,a=!0,n=0;for(;a&&n<100;){a=!1,n++;let e=t.match(/z\.[a-zA-Z]+\(/);if(e){let n=e.index,r=n+e[0].length-1,i=1,s=r+1,o=null,l=!1;for(;s<t.length&&i>0;){let e=t[s];l||'"'!==e&&"'"!==e?!o&&("("===e?i++:")"===e&&i--):o?o===e&&(o=null):o=e,l="\\"===e&&!l,s++}if(0===i){let e=s;for(;e<t.length;){let a=t.slice(e).match(/^\.[a-zA-Z]+\(/);if(a){let n=1,r=e+a[0].length-1+1,i=null,s=!1;for(;r<t.length&&n>0;){let e=t[r];s||'"'!==e&&"'"!==e?!i&&("("===e?n++:")"===e&&n--):i?i===e&&(i=null):i=e,s="\\"===e&&!s,r++}if(0===n)e=r;else break}else break}t=t.slice(0,n)+'"'.concat(this.CONFIG.ZOD_PLACEHOLDER,'"')+t.slice(e),a=!0}else t=t.replace(/z\.[a-zA-Z]+/,'"'.concat(this.CONFIG.ZOD_PLACEHOLDER,'"')),a=!0}}return(t=t.replace(/z\.enum\(\[[^\]]*\]\)/g,'"'.concat(this.CONFIG.ZOD_PLACEHOLDER,'"'))).replace(/z\.\w+/g,'"'.concat(this.CONFIG.ZOD_PLACEHOLDER,'"'))}static validateAndSanitize(e){if("object"!=typeof e||null===e)throw this.createParserError("Definition must be an object","INVALID_DEFINITION");let t={fields:[]};for(let[a,n]of Object.entries(e)){if(!this.ALLOWED_KEYS.includes(a)){this.CONFIG.ENABLE_STRICT_VALIDATION&&console.warn("Unknown key '".concat(a,"' found in form definition, skipping"));continue}switch(a){case"schema":n&&"object"==typeof n&&(t.schema=n);break;case"fields":if(!Array.isArray(n))throw this.createParserError("Fields must be an array","INVALID_FIELDS");t.fields=this.validateFields(n);break;case"pages":Array.isArray(n)&&(t.pages=n.map((e,t)=>this.validatePage(e,t)));break;case"title":case"description":t[a]="string"==typeof n?n:void 0;break;case"submitLabel":"string"==typeof n&&(t.submitLabel=n);break;case"nextLabel":"string"==typeof n&&(t.nextLabel=n);break;case"previousLabel":"string"==typeof n&&(t.previousLabel=n);break;case"formClassName":"string"==typeof n&&(t.formClassName=n);break;case"fieldClassName":"string"==typeof n&&(t.fieldClassName=n);break;case"progress":n&&"object"==typeof n&&(t.progress=n);break;case"formOptions":n&&"object"==typeof n&&(t.formOptions=n);break;case"layout":n&&"object"==typeof n&&(t.layout=n);break;case"tabs":Array.isArray(n)&&(t.tabs=n);break;case"collapseLabel":"string"==typeof n&&(t.collapseLabel=n);break;case"expandLabel":"string"==typeof n&&(t.expandLabel=n);break;case"labelClassName":"string"==typeof n&&(t.labelClassName=n);break;case"buttonClassName":"string"==typeof n&&(t.buttonClassName=n);break;case"submitButtonClassName":"string"==typeof n&&(t.submitButtonClassName=n);break;case"autoScroll":"boolean"==typeof n&&(t.autoScroll=n);break;case"autoSubmitOnChange":"boolean"==typeof n&&(t.autoSubmitOnChange=n);break;case"autoSubmitDebounceMs":"number"==typeof n&&(t.autoSubmitDebounceMs=n);break;case"disabled":"boolean"==typeof n&&(t.disabled=n);break;case"loading":"boolean"==typeof n&&(t.loading=n);break;case"resetOnSubmitSuccess":"boolean"==typeof n&&(t.resetOnSubmitSuccess=n);break;case"showSubmitButton":"boolean"==typeof n&&(t.showSubmitButton=n);break;case"crossFieldValidation":Array.isArray(n)&&(t.crossFieldValidation=n);break;case"asyncValidation":n&&"object"==typeof n&&(t.asyncValidation=n);break;case"analytics":n&&"object"==typeof n&&(t.analytics=n);break;case"persistence":n&&"object"==typeof n&&(t.persistence=n);break;case"conditionalSections":Array.isArray(n)&&(t.conditionalSections=n)}}return t}static validateFields(e){return e.map((e,t)=>{if("object"!=typeof e||null===e)throw this.createParserError("Field at index ".concat(t," must be an object"),"INVALID_FIELD",{fieldIndex:t});if(!e.name||!e.type)throw this.createParserError("Field at index ".concat(t," must have 'name' and 'type' properties"),"MISSING_REQUIRED_FIELD",{fieldIndex:t});if("string"!=typeof e.name||"string"!=typeof e.type)throw this.createParserError("Field at index ".concat(t," must have string 'name' and 'type' properties"),"INVALID_FIELD_TYPE",{fieldIndex:t});if(!this.ALLOWED_FIELD_TYPES.includes(e.type))throw this.createParserError("Field at index ".concat(t," has invalid type '").concat(e.type,"'. Supported types: ").concat(this.ALLOWED_FIELD_TYPES.join(", ")),"UNSUPPORTED_FIELD_TYPE",{fieldIndex:t,fieldType:e.type});let a={name:e.name,type:e.type};return this.addOptionalStringProperty(a,e,"label"),this.addOptionalStringProperty(a,e,"placeholder"),this.addOptionalStringProperty(a,e,"description"),this.addOptionalStringProperty(a,e,"tab"),"boolean"==typeof e.required&&(a.required=e.required),"number"==typeof e.page&&(a.page=e.page),void 0!==e.defaultValue&&(a.defaultValue=e.defaultValue),this.addOptionalNumberProperty(a,e,"min"),this.addOptionalNumberProperty(a,e,"max"),this.addOptionalNumberProperty(a,e,"step"),this.addFieldSpecificConfigurations(a,e,t),e.options&&Array.isArray(e.options)&&(a.options=this.validateOptions(e.options)),a})}static addFieldSpecificConfigurations(e,t,a){let n=e.type;"array"===n&&t.arrayConfig&&(e.arrayConfig=this.validateArrayConfig(t.arrayConfig,a)),"object"===n&&t.objectConfig&&(e.objectConfig=this.validateObjectConfig(t.objectConfig,a)),"multiSelect"===n&&t.multiSelectConfig&&(e.multiSelectConfig=this.validateMultiSelectConfig(t.multiSelectConfig)),"colorPicker"===n&&t.colorConfig&&(e.colorConfig=this.validateColorConfig(t.colorConfig)),"rating"===n&&t.ratingConfig&&(e.ratingConfig=this.validateRatingConfig(t.ratingConfig)),"phone"===n&&t.phoneConfig&&(e.phoneConfig=this.validatePhoneConfig(t.phoneConfig)),t.datalist&&(e.datalist=this.validateDatalistConfig(t.datalist)),["sliderConfig","fileConfig","locationConfig","durationConfig","autocompleteConfig","maskedConfig","dateConfig","textareaConfig","passwordConfig","emailConfig","numberConfig"].forEach(a=>{t[a]&&"object"==typeof t[a]&&(e[a]=t[a])})}static addOptionalStringProperty(e,t,a){t[a]&&"string"==typeof t[a]&&(e[a]=t[a])}static addOptionalNumberProperty(e,t,a){"number"==typeof t[a]&&(e[a]=t[a])}static validateArrayConfig(e,t){if("object"!=typeof e||!e)throw this.createParserError("Array config at field index ".concat(t," must be an object"),"INVALID_ARRAY_CONFIG");let a={itemType:"text"};return e.itemType&&"string"==typeof e.itemType&&(a.itemType=e.itemType),["itemLabel","itemPlaceholder","addButtonLabel","removeButtonLabel"].forEach(t=>{e[t]&&"string"==typeof e[t]&&(a[t]=e[t])}),["minItems","maxItems"].forEach(t=>{"number"==typeof e[t]&&(a[t]=e[t])}),"boolean"==typeof e.sortable&&(a.sortable=e.sortable),e.objectConfig&&(a.objectConfig=this.validateObjectConfig(e.objectConfig,t)),a}static validateObjectConfig(e,t){if("object"!=typeof e||!e)throw this.createParserError("Object config at field index ".concat(t," must be an object"),"INVALID_OBJECT_CONFIG");let a={fields:[]};return e.fields&&Array.isArray(e.fields)&&(a.fields=e.fields.map(e=>{if("object"!=typeof e||!e)return{name:"",type:"text"};let t={name:"string"==typeof e.name?e.name:"",type:"string"==typeof e.type?e.type:"text"};return"string"==typeof e.label&&(t.label=e.label),"string"==typeof e.placeholder&&(t.placeholder=e.placeholder),"string"==typeof e.description&&(t.description=e.description),"number"==typeof e.min&&(t.min=e.min),"number"==typeof e.max&&(t.max=e.max),"number"==typeof e.step&&(t.step=e.step),e.options&&(Array.isArray(e.options)||"function"==typeof e.options)&&(t.options=e.options),t})),["title","description","collapseLabel","expandLabel"].forEach(t=>{e[t]&&"string"==typeof e[t]&&(a[t]=e[t])}),["collapsible","defaultExpanded","showCard"].forEach(t=>{"boolean"==typeof e[t]&&(a[t]=e[t])}),e.layout&&["vertical","horizontal","grid"].includes(e.layout)&&(a.layout=e.layout),"number"==typeof e.columns&&(a.columns=e.columns),a}static validateMultiSelectConfig(e){if("object"!=typeof e||!e)return;let t={};return"number"==typeof e.maxSelections&&(t.maxSelections=e.maxSelections),["searchable","creatable"].forEach(a=>{"boolean"==typeof e[a]&&(t[a]=e[a])}),["placeholder","noOptionsText","loadingText"].forEach(a=>{e[a]&&"string"==typeof e[a]&&(t[a]=e[a])}),t}static validateColorConfig(e){if("object"!=typeof e||!e)return;let t={};return e.format&&["hex","rgb","hsl"].includes(e.format)&&(t.format=e.format),["showPreview","showAlpha","allowCustom"].forEach(a=>{"boolean"==typeof e[a]&&(t[a]=e[a])}),Array.isArray(e.presetColors)&&(t.presetColors=e.presetColors.filter(e=>"string"==typeof e)),t}static validateRatingConfig(e){if("object"!=typeof e||!e)return;let t={};return"number"==typeof e.max&&(t.max=e.max),["allowHalf","allowClear","showValue"].forEach(a=>{"boolean"==typeof e[a]&&(t[a]=e[a])}),e.icon&&["star","heart","thumbs"].includes(e.icon)&&(t.icon=e.icon),e.size&&["sm","md","lg","small","medium","large"].includes(e.size)&&(t.size=e.size),t}static validatePhoneConfig(e){if("object"!=typeof e||!e)return;let t={};return e.defaultCountry&&"string"==typeof e.defaultCountry&&(t.defaultCountry=e.defaultCountry),["preferredCountries","onlyCountries","excludeCountries"].forEach(a=>{Array.isArray(e[a])&&(t[a]=e[a].filter(e=>"string"==typeof e))}),e.format&&["national","international"].includes(e.format)&&(t.format=e.format),t}static validateDatalistConfig(e){if("object"!=typeof e||!e)return;let t={};return Array.isArray(e.options)&&(t.options=e.options.filter(e=>"string"==typeof e)),["debounceMs","minChars","maxResults"].forEach(a=>{"number"==typeof e[a]&&(t[a]=e[a])}),t}static validateOptions(e){return e.filter(e=>"object"==typeof e&&null!==e&&"string"==typeof e.value&&"string"==typeof e.label).map(e=>({value:e.value,label:e.label}))}static validatePage(e,t){if("object"!=typeof e||!e)return{page:t};let a={page:"number"==typeof e.page?e.page:t};return e.title&&"string"==typeof e.title&&(a.title=e.title),e.description&&"string"==typeof e.description&&(a.description=e.description),a}static parseWithSchemaInference(e,t){let a=this.parse(e),n=.5,r=null;if(null==t?void 0:t.enabled)try{let e={};for(let t of a.fields||[]){let a=this.inferZodTypeFromField(t);a&&(e[t.name]=a,n+=.1)}r={type:"object",properties:e,isInferred:!0},n=Math.min(n,1)}catch(e){console.warn("Schema inference failed:",e),n=.1}return{config:a,inferredSchema:r,confidence:n}}static mergeSchemas(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"extend",n={...e};if(!t||"object"!=typeof t)return n;try{if("extend"===a&&t.properties){let e=new Set((n.fields||[]).map(e=>e.name)),a=t.properties;for(let[t,r]of Object.entries(a))if(!e.has(t)){let e=this.createFieldFromSchema(t,r);e&&n.fields&&n.fields.push(e)}}else if("override"===a)t&&"object"==typeof t&&"_def"in t&&(n.schema=t);else if("intersect"===a){let e=t.properties||{};n.fields=(n.fields||[]).filter(t=>Object.prototype.hasOwnProperty.call(e,t.name))}"override"!==a&&t&&"object"==typeof t&&"_def"in t&&(n.schema=t)}catch(e){console.warn("Schema merging failed:",e)}return n}static validateWithSuggestions(e){let t=[],a=[];try{return this.parse(e),{isValid:!0,errors:[],suggestions:[]}}catch(o){let n="syntax",r="Unknown parsing error",i="",s=[];return o instanceof Error&&((r=o.message).includes("Invalid syntax")||r.includes("JSON.parse")?(n="syntax",i="Check for missing quotes around object keys or trailing commas",s=['{ "name": "field1", "type": "text" }','{ fields: [{ name: "field1", type: "text" }] }'],a.push("Use double quotes around object keys"),a.push("Remove trailing commas before closing brackets")):r.includes("invalid type")?(n="field_type",i="Use one of the supported field types: ".concat(this.ALLOWED_FIELD_TYPES.join(", ")),s=['{ name: "email", type: "email" }','{ name: "age", type: "number" }'],a.push("Check field type spelling"),a.push("Refer to supported field types list")):r.includes("must have")?(n="validation",i="Ensure all required properties are present",s=['{ name: "required-field", type: "text", label: "Required Field" }'],a.push("Add missing required properties: name, type")):r.includes("schema")&&(n="schema",i="Check Zod schema syntax and structure",s=["schema: z.object({ name: z.string(), email: z.string().email() })"],a.push("Verify Zod schema syntax"))),t.push({type:n,message:r,suggestion:i,examples:s,location:this.extractErrorLocation(e,o)}),a.push("Validate JSON syntax using a JSON validator"),a.push("Check for balanced parentheses and brackets"),a.push("Ensure all string values are properly quoted"),{isValid:!1,errors:t,suggestions:a}}}static inferZodTypeFromField(e){let t={text:"z.string()",email:"z.string().email()",password:"z.string().min(1)",url:"z.string().url()",tel:"z.string()",textarea:"z.string()",number:"z.number()",date:"z.string().datetime()",checkbox:"z.boolean()",switch:"z.boolean()",select:"z.string()",radio:"z.string()",multiSelect:"z.array(z.string())",file:"z.instanceof(File)",slider:"z.number()",rating:"z.number()",phone:"z.string()",colorPicker:"z.string()",location:"z.object({ lat: z.number(), lng: z.number() })",duration:"z.number()",autocomplete:"z.string()",masked:"z.string()",array:"z.array(z.unknown())",object:"z.object({})"}[e.type];return t?(("text"===e.type||"textarea"===e.type)&&(e.min&&e.max?t=t.replace("z.string()","z.string().min(".concat(e.min,").max(").concat(e.max,")")):e.min?t=t.replace("z.string()","z.string().min(".concat(e.min,")")):e.max&&(t=t.replace("z.string()","z.string().max(".concat(e.max,")")))),("number"===e.type||"slider"===e.type)&&(e.min&&e.max?t=t.replace("z.number()","z.number().min(".concat(e.min,").max(").concat(e.max,")")):e.min?t=t.replace("z.number()","z.number().min(".concat(e.min,")")):e.max&&(t=t.replace("z.number()","z.number().max(".concat(e.max,")")))),!1===e.required&&(t+=".optional()"),t):null}static createFieldFromSchema(e,t){try{let a="text";return"string"===t.type?a="text":"number"===t.type?a="number":"boolean"===t.type&&(a="checkbox"),{name:e,type:a,label:e.charAt(0).toUpperCase()+e.slice(1).replace(/([A-Z])/g," $1")}}catch(e){return null}}static extractErrorLocation(e,t){try{let a=t instanceof Error?t.message:String(t),n=a.match(/at position (\d+)/i);if(n){let t=parseInt(n[1],10),a=e.substring(0,t).split("\n");return{line:a.length,column:a[a.length-1].length+1}}let r=a.match(/field at index (\d+)/i);if(r)return{field:"field[".concat(r[1],"]")}}catch(e){}}}J.ALLOWED_FIELD_TYPES=["text","email","password","url","tel","textarea","select","checkbox","switch","number","date","slider","file","rating","phone","colorPicker","location","duration","multiSelect","autocomplete","masked","object","array","radio"],J.ALLOWED_KEYS=["fields","schema","title","description","submitLabel","nextLabel","previousLabel","collapseLabel","expandLabel","formClassName","fieldClassName","labelClassName","buttonClassName","submitButtonClassName","autoScroll","pages","progress","tabs","autoSubmitOnChange","autoSubmitDebounceMs","disabled","loading","resetOnSubmitSuccess","showSubmitButton","crossFieldValidation","asyncValidation","analytics","layout","conditionalSections","persistence","formOptions"],J.CONFIG={ZOD_PLACEHOLDER:"__ZOD_SCHEMA__",MAX_RECURSION_DEPTH:10,ENABLE_STRICT_VALIDATION:!0,MAX_CODE_LENGTH:1e6,MAX_NESTING_DEPTH:50};var K=a(93425);function H(e){let{formCode:t,isStreaming:a=!1,onFormSubmit:i,className:s,title:o="Form Preview",emptyStateMessage:l="No form generated yet. The preview will appear here once a form is created."}=e,c=(0,r.useMemo)(()=>{if(!t)return null;try{var e;console.log("Attempting to parse form code:",{codeLength:t.length,codePreview:t.substring(0,200)+"..."});let a=J.parse(t);return console.log("Successfully parsed form config:",{fieldsCount:(null==(e=a.fields)?void 0:e.length)||0,hasSchema:!!a.schema}),a}catch(e){return console.error("Error parsing form configuration:",{error:e instanceof Error?e.message:String(e),formCodePreview:t.substring(0,500)}),null}},[t]);return t||a?(0,n.jsx)(C.Zp,{className:(0,u.cn)("flex flex-col h-full",s),children:(0,n.jsx)(C.Wu,{className:(0,u.cn)("flex-1 overflow-hidden","p-0"),children:(0,n.jsxs)("div",{className:"h-full",children:[a&&!t&&(0,n.jsx)("div",{className:"p-3",children:(0,n.jsxs)(F,{children:[(0,n.jsx)(A.A,{className:"h-4 w-4"}),(0,n.jsx)(T,{children:"Form is being generated... Please wait for completion."})]})}),t&&c&&(0,n.jsx)(G.b,{config:c,code:t,showModeSelector:!0,showDeviceSelector:!0,onFormSubmit:i,className:"border-0 h-full"}),t&&!c&&(0,n.jsx)("div",{className:"p-3",children:(0,n.jsxs)(F,{variant:"destructive",children:[(0,n.jsx)(A.A,{className:"h-4 w-4"}),(0,n.jsx)(T,{children:"Failed to parse the form configuration. The form may have invalid syntax."})]})})]})})}):(0,n.jsx)(C.Zp,{className:(0,u.cn)("flex flex-col h-full",s),children:(0,n.jsx)(C.Wu,{className:"flex-1 flex items-center justify-center",children:(0,n.jsxs)("div",{className:"text-center text-muted-foreground",children:[(0,n.jsx)(K.A,{className:"h-12 w-12 mb-4 opacity-50 mx-auto"}),(0,n.jsx)("h3",{className:"text-lg font-medium mb-2",children:"No Form Available"}),(0,n.jsx)("p",{className:"text-sm max-w-md",children:l})]})})})}var $=a(85958),Y=a(15870),W=a(27911),X=a(68262);function Q(e){let{forms:t,currentFormIndex:a,onFormIndexChange:r,onDeleteForm:i,isStreaming:s=!1,onFormSubmit:o,className:l}=e,c=t[a];return 0!==t.length||s?(0,n.jsxs)(C.Zp,{className:(0,u.cn)("flex flex-col h-full",l),children:[(0,n.jsx)(C.aR,{className:"px-3 pt-1 pb-0",children:(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)(C.ZB,{className:"flex items-center gap-2",children:[(0,n.jsx)($.A,{className:"h-5 w-5"}),"Preview",t.length>0&&(0,n.jsxs)("span",{className:"text-sm font-normal text-muted-foreground",children:["(",a+1," of ",t.length,")"]})]}),t.length>1&&(0,n.jsxs)("div",{className:"flex items-center gap-1",children:[(0,n.jsxs)(v.$,{variant:"outline",size:"sm",onClick:()=>r(Math.max(0,a-1)),disabled:0===a,className:"h-8 w-8 p-0",children:[(0,n.jsx)(Y.A,{className:"h-4 w-4"}),(0,n.jsx)("span",{className:"sr-only",children:"Previous form"})]}),(0,n.jsxs)(v.$,{variant:"outline",size:"sm",onClick:()=>r(Math.min(t.length-1,a+1)),disabled:a===t.length-1,className:"h-8 w-8 p-0",children:[(0,n.jsx)(W.A,{className:"h-4 w-4"}),(0,n.jsx)("span",{className:"sr-only",children:"Next form"})]}),i&&t.length>1&&(0,n.jsxs)(v.$,{variant:"outline",size:"sm",onClick:()=>i(a),className:"h-8 w-8 p-0 text-destructive hover:text-destructive",children:[(0,n.jsx)(X.A,{className:"h-4 w-4"}),(0,n.jsx)("span",{className:"sr-only",children:"Delete form"})]})]})]})}),(0,n.jsx)(C.Wu,{className:"flex-1 overflow-hidden",children:(0,n.jsx)(H,{formCode:null==c?void 0:c.code,isStreaming:s&&!c,onFormSubmit:o,className:"border-0 h-full"})})]}):(0,n.jsx)(H,{className:l,title:"",emptyStateMessage:"Start a conversation in the chat to generate your first form. The preview will appear here once the AI creates your form."})}var ee=a(4595),et=a(24508),ea=a(28442);function en(e){let{isCollapsed:t,onToggleCollapse:a,activeView:r,onViewChange:i}=e,s=e=>{r===e?i(null):i(e)};return(0,n.jsxs)("div",{className:"flex flex-col w-12 bg-muted/20 border-r border-border",children:[(0,n.jsxs)(v.$,{variant:"ghost",size:"icon",onClick:a,className:"h-12 w-12 rounded-none border-b border-border hover:bg-muted/40",children:[t?(0,n.jsx)(W.A,{className:"h-4 w-4"}):(0,n.jsx)(Y.A,{className:"h-4 w-4"}),(0,n.jsx)("span",{className:"sr-only",children:t?"Expand sidebar":"Collapse sidebar"})]}),(0,n.jsxs)("div",{className:"flex flex-col",children:[(0,n.jsxs)(v.$,{variant:"ghost",size:"icon",onClick:()=>s("history"),className:(0,u.cn)("h-12 w-12 rounded-none hover:bg-muted/40","history"===r&&"bg-muted text-foreground"),children:[(0,n.jsx)(ee.A,{className:"h-4 w-4"}),(0,n.jsx)("span",{className:"sr-only",children:"History"})]}),(0,n.jsxs)(v.$,{variant:"ghost",size:"icon",onClick:()=>s("settings"),className:(0,u.cn)("h-12 w-12 rounded-none hover:bg-muted/40","settings"===r&&"bg-muted text-foreground"),children:[(0,n.jsx)(et.A,{className:"h-4 w-4"}),(0,n.jsx)("span",{className:"sr-only",children:"Settings"})]}),(0,n.jsxs)(v.$,{variant:"ghost",size:"icon",onClick:()=>s("provider"),className:(0,u.cn)("h-12 w-12 rounded-none hover:bg-muted/40","provider"===r&&"bg-muted text-foreground"),children:[(0,n.jsx)(ea.A,{className:"h-4 w-4"}),(0,n.jsx)("span",{className:"sr-only",children:"Provider"})]}),(0,n.jsxs)(v.$,{variant:"ghost",size:"icon",onClick:()=>s("parser"),className:(0,u.cn)("h-12 w-12 rounded-none hover:bg-muted/40","parser"===r&&"bg-muted text-foreground"),children:[(0,n.jsx)(K.A,{className:"h-4 w-4"}),(0,n.jsx)("span",{className:"sr-only",children:"Form Parser Settings"})]})]})]})}var er=a(64148),ei=a(93385);function es(e){let{conversations:t,currentConversationId:a,onSelectConversation:r,onDeleteConversation:i,onNewConversation:s,onExportConversation:o,className:l}=e,c=e=>{var t;if(e.title)return e.title;let a=null==(t=e.messages)?void 0:t.find(e=>"user"===e.role);if(null==a?void 0:a.content){let e=a.content;return e.length>50?e.substring(0,50)+"...":e}return"New Conversation"};return(0,n.jsxs)(C.Zp,{className:(0,u.cn)("h-full",l),children:[(0,n.jsx)(C.aR,{className:"pb-3",children:(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)(C.ZB,{className:"flex items-center gap-2",children:[(0,n.jsx)(ee.A,{className:"h-5 w-5"}),"Conversation History",(0,n.jsx)(er.E,{variant:"secondary",children:t.length})]}),s&&(0,n.jsxs)(v.$,{variant:"outline",size:"sm",onClick:s,className:"h-8 w-8 p-0",children:[(0,n.jsx)(j.A,{className:"h-4 w-4"}),(0,n.jsx)("span",{className:"sr-only",children:"New conversation"})]})]})}),(0,n.jsx)(C.Wu,{className:"px-4 pt-0 pb-4",children:(0,n.jsx)("div",{className:"h-[300px] overflow-y-auto",children:0===t.length?(0,n.jsxs)("div",{className:"flex flex-col items-center justify-center h-full text-center text-muted-foreground py-8",children:[(0,n.jsx)(w.A,{className:"h-8 w-8 mb-2 opacity-50"}),(0,n.jsx)("p",{className:"text-sm",children:"No conversations yet"}),(0,n.jsx)("p",{className:"text-xs",children:"Start a chat to see your history"})]}):(0,n.jsx)("div",{className:"space-y-1",children:t.map(e=>(0,n.jsxs)("div",{className:(0,u.cn)("group flex items-center justify-between gap-2 px-2 py-1.5 rounded hover:bg-muted/50 cursor-pointer text-sm",a===e.id&&"bg-muted"),onClick:()=>r(e),children:[(0,n.jsx)("div",{className:"flex-1 min-w-0",children:(0,n.jsx)("p",{className:"font-medium truncate text-sm",children:c(e)})}),(0,n.jsxs)("div",{className:"flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity shrink-0",children:[o&&(0,n.jsx)(v.$,{type:"button",variant:"ghost",size:"icon",className:"h-5 w-5",onClick:t=>{t.stopPropagation(),o(e)},children:(0,n.jsx)(ei.A,{className:"h-3 w-3"})}),(0,n.jsx)(v.$,{type:"button",variant:"ghost",size:"icon",className:"h-5 w-5 text-destructive hover:text-destructive",onClick:t=>{t.stopPropagation(),i(e.id)},children:(0,n.jsx)(X.A,{className:"h-3 w-3"})})]})]},e.id))})})})]})}var eo=a(73297);let el=async e=>{let t=await fetch("https://openrouter.ai/api/v1/models",{headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(!t.ok)throw Error("HTTP error! status: ".concat(t.status));return(await t.json()).data.filter(e=>e.id&&e.name&&""!==e.id.trim()).map(e=>({value:e.id,label:e.name})).sort((e,t)=>e.label.localeCompare(t.label))},ec=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return(0,r.useMemo)(()=>"openai"===e?[{value:"gpt-5",label:"GPT-5"},{value:"gpt-5-mini",label:"GPT-5 Mini"},{value:"gpt-4o",label:"GPT-4o"},{value:"gpt-4o-mini",label:"GPT-4o Mini"}]:"anthropic"===e?[{value:"claude-sonnet-4",label:"Claude Sonnet 4"},{value:"claude-3-5-sonnet-20241022",label:"Claude 3.5 Sonnet"},{value:"claude-3-haiku-20240307",label:"Claude 3 Haiku"}]:"google"===e?[{value:"gemini-2.5-pro",label:"Gemini 2.5 Pro"},{value:"gemini-1.5-pro",label:"Gemini 1.5 Pro"},{value:"gemini-1.5-flash",label:"Gemini 1.5 Flash"}]:"mistral"===e?[{value:"mistral-large-2407",label:"Mistral Large 2407"},{value:"mistral-medium-2312",label:"Mistral Medium 2312"},{value:"mistral-small-2312",label:"Mistral Small 2312"}]:"openrouter"===e?a?[{value:"loading",label:"Loading models..."}]:t.length>0?t.filter(e=>e.value&&""!==e.value.trim()):[{value:"openrouter/kimiplus-k2",label:"OpenRouter Kimi Plus K2"},{value:"moonshotai/moonshot-k2",label:"Moonshot K2"}]:"openai-compatible"===e?[{value:"gpt-4.1-mini",label:"GPT-4.1 Mini"},{value:"custom-model",label:"Custom Model"}]:[],[e,t,a])};function ed(e){let{providerConfig:t,onConfigChange:a,className:r}=e,{data:i=[],isLoading:s,error:o}=(0,eo.I)({queryKey:["openrouter-models",null==t?void 0:t.apiKey],queryFn:()=>el((null==t?void 0:t.apiKey)||""),enabled:(null==t?void 0:t.provider)==="openrouter"&&!!(null==t?void 0:t.apiKey)&&t.apiKey.length>0,staleTime:3e5,gcTime:6e5,retry:1}),c=ec(null==t?void 0:t.provider,i,s),{Form:d}=(0,l.X)({fields:t?[{name:"model",type:"select",label:"Model",placeholder:"Select a model",options:(null==t?void 0:t.provider)==="openrouter"&&o?[{value:"error",label:"Failed to load models - check API key"}]:c},{name:"temperature",type:"slider",label:"Temperature: ".concat(((null==t?void 0:t.temperature)||.7).toFixed(2)),sliderConfig:{min:0,max:1,step:.01},description:"Controls randomness: Focused ← → Creative"},{name:"maxTokens",type:"number",label:"Max Tokens",placeholder:"2000",description:"Maximum response length",numberConfig:{min:1,max:32768}}]:[],formOptions:{defaultValues:{model:(null==t?void 0:t.model)||"",temperature:(null==t?void 0:t.temperature)||.7,maxTokens:(null==t?void 0:t.maxTokens)||2e3},onSubmit:async e=>{let{value:n}=e;t&&a({...t,model:n.model,temperature:n.temperature,maxTokens:n.maxTokens})}},submitLabel:"\uD83D\uDCBE Save Model Settings",showSubmitButton:!!t,autoSubmitOnChange:!1});return(0,n.jsxs)("div",{className:"p-4 space-y-4 ".concat(r||""),children:[(0,n.jsx)("h3",{className:"text-base font-semibold",children:"Model Settings"}),t?(0,n.jsx)(d,{}):(0,n.jsx)("p",{className:"text-muted-foreground",children:"Select a provider first to configure model settings"})]})}var em=a(44057),eu=a(13444),ep=a(4931),ef=a(76608);function eg(e){var t,a,i,s;let{className:o,onConfigChange:c}=e,[d,m]=(0,r.useState)(R),[u,p]=(0,r.useState)(R),[f,g]=(0,r.useState)(!1);(0,r.useEffect)(()=>{try{let e=localStorage.getItem("formedible-parser-config");if(e){let t=JSON.parse(e);t&&"object"==typeof t&&"boolean"==typeof t.strictValidation&&"boolean"==typeof t.enableSchemaInference&&("extend"===t.mergeStrategy||"override"===t.mergeStrategy||"intersect"===t.mergeStrategy)&&"boolean"==typeof t.fieldTypeValidation&&(void 0===t.customInstructions||"string"==typeof t.customInstructions)&&"number"==typeof t.maxCodeLength&&"number"==typeof t.maxNestingDepth&&"boolean"==typeof t.enableZodParsing&&"boolean"==typeof t.showDetailedErrors&&"boolean"==typeof t.selectFields&&Array.isArray(t.systemPromptFields)&&t.systemPromptFields.every(e=>"string"==typeof e)&&"boolean"==typeof t.includeTabFormatting&&"boolean"==typeof t.includePageFormatting&&(m(t),p(t))}}catch(e){console.warn("Failed to load parser config:",e)}},[]);let h=JSON.stringify(d)!==JSON.stringify(u),b=e=>{try{localStorage.setItem("formedible-parser-config",JSON.stringify(e)),m(e),p(e),null==c||c(e)}catch(e){console.error("Failed to save parser config:",e)}},y=async()=>{try{let e=M(u);await navigator.clipboard.writeText(e||"System prompt will be generated based on current configuration..."),g(!0),setTimeout(()=>g(!1),2e3)}catch(e){console.error("Failed to copy system prompt:",e)}},x=[...q.filter(e=>["strictValidation","enableSchemaInference","fieldTypeValidation"].includes(e.name)).map(e=>({...e})),{name:"showAdvanced",type:"switch",label:"Show Advanced Settings",description:"Display advanced configuration options",defaultValue:!1},...q.filter(e=>!["strictValidation","enableSchemaInference","fieldTypeValidation","selectFields","systemPromptFields","includeTabFormatting","includePageFormatting"].includes(e.name)).map(e=>({...e,conditional:e=>!0===e.showAdvanced})),...q.filter(e=>["selectFields","systemPromptFields"].includes(e.name)).map(e=>({...e,conditional:"systemPromptFields"===e.name?e=>!0===e.selectFields:void 0})),...q.filter(e=>["includeTabFormatting","includePageFormatting"].includes(e.name))],{Form:N,form:w}=(0,l.X)({fields:x,formOptions:{defaultValues:{...d,showAdvanced:!1,selectFields:null!=(t=d.selectFields)&&t,systemPromptFields:null!=(a=d.systemPromptFields)?a:R.systemPromptFields,includeTabFormatting:null!=(i=d.includeTabFormatting)?i:R.includeTabFormatting,includePageFormatting:null!=(s=d.includePageFormatting)?s:R.includePageFormatting},onSubmit:async e=>{var t;let{value:a}=e,{showAdvanced:n,...r}=a;b((t={...d,...r},{...R,...t}))}},submitLabel:h?"Save Settings":"Settings Saved",showSubmitButton:h,autoSubmitOnChange:!1,layout:{type:"grid",columns:1,gap:"md"}});return(0,n.jsxs)("div",{className:"space-y-4 ".concat(o||""),children:[(0,n.jsxs)(C.Zp,{children:[(0,n.jsxs)(C.aR,{className:"pb-3",children:[(0,n.jsxs)(C.ZB,{className:"flex items-center gap-2 text-base",children:[(0,n.jsx)(em.A,{className:"h-4 w-4"}),"Form Parser Settings"]}),(0,n.jsx)(C.BT,{children:"Configure how the Formedible parser processes form definitions and handles AI interactions."})]}),(0,n.jsxs)(C.Wu,{className:"space-y-4",children:[(0,n.jsx)("div",{className:"space-y-4",children:(0,n.jsx)(N,{})}),(0,n.jsxs)("div",{className:"flex flex-wrap gap-2 pt-4 border-t",children:[(0,n.jsxs)(v.$,{onClick:()=>{b({...R})},variant:"outline",size:"sm",className:"flex items-center gap-2",children:[(0,n.jsx)(eu.A,{className:"h-3 w-3"}),"Reset to Defaults"]}),(0,n.jsx)(v.$,{onClick:y,variant:f?"default":"outline",size:"sm",className:"flex items-center gap-2",children:f?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(ep.A,{className:"h-3 w-3"}),"Copied!"]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(ef.A,{className:"h-3 w-3"}),"Copy Prompt"]})})]})]})]}),(0,n.jsxs)(C.Zp,{children:[(0,n.jsx)(C.aR,{className:"pb-3",children:(0,n.jsx)(C.ZB,{className:"text-sm",children:"System Prompt Preview"})}),(0,n.jsx)(C.Wu,{children:(0,n.jsx)("div",{className:"p-3 bg-muted rounded-md text-xs overflow-auto max-h-64",children:(0,n.jsx)("pre",{className:"whitespace-pre-wrap",children:M(u)||"System prompt will be generated based on current saved configuration..."})})})]})]})}function eh(e){let{activeView:t,isCollapsed:a,className:r,conversations:i,currentConversationId:s,onSelectConversation:o,onDeleteConversation:l,onNewConversation:c,onExportConversation:d,providerConfig:p,onConfigChange:f}=e;return a||!t?null:(0,n.jsx)("div",{className:(0,u.cn)("w-80 border-r border-border bg-background/50 transition-all duration-200 ease-in-out overflow-hidden",a?"w-0":"w-80",r),children:(0,n.jsx)("div",{className:"h-full p-2 overflow-y-auto",children:(()=>{switch(t){case"history":return(0,n.jsx)(es,{conversations:i,currentConversationId:s,onSelectConversation:o,onDeleteConversation:l,onNewConversation:c,onExportConversation:d,className:"border-0 shadow-none h-full"});case"settings":return(0,n.jsx)(C.Zp,{className:"h-full",children:(0,n.jsx)(ed,{providerConfig:p,onConfigChange:f,className:"h-full"})});case"provider":return(0,n.jsx)(C.Zp,{className:"h-full",children:(0,n.jsx)(m,{onConfigChange:f,initialConfig:p,className:"h-full"})});case"parser":return(0,n.jsx)(eg,{className:"h-full"});default:return null}})()})})}var eb=a(51778);let ey=new s.E({defaultOptions:{queries:{staleTime:3e5,gcTime:6e5,retry:1}}}),ex={PROVIDER_CONFIG:"formedible-ai-builder-provider-config",CONVERSATIONS:"formedible-ai-builder-conversations",UI_STATE:"formedible-ai-builder-ui-state"};function ev(e){let{className:t,onFormGenerated:a,onFormSubmit:i,mode:s="direct",backendConfig:o}=e,[l,d]=(0,r.useState)(null),[p,f]=(0,r.useState)([]),[g,h]=(0,r.useState)(0),[b,y]=(0,r.useState)(!1),[x,v]=(0,r.useState)([]),[N,C]=(0,r.useState)(),[w,j]=(0,r.useState)([]),[S,D]=(0,r.useState)(!1),[k,E]=(0,r.useState)(null),[A,I]=(0,r.useState)(!1),P=(0,r.useCallback)(()=>"backend"===s?!!(o&&o.endpoint&&o.endpoint.trim().length>0):!!l&&(["openai","anthropic","google","mistral","openrouter"].includes(l.provider)?!!(l.apiKey&&l.apiKey.trim().length>0):"openai-compatible"!==l.provider||!!(l.endpoint&&l.endpoint.trim().length>0)),[s,o,l]);(0,r.useEffect)(()=>{try{let e=localStorage.getItem(ex.PROVIDER_CONFIG);e&&d(JSON.parse(e));let t=localStorage.getItem(ex.CONVERSATIONS),a=[];t&&(a=JSON.parse(t).map(e=>({...e,createdAt:new Date(e.createdAt),updatedAt:new Date(e.updatedAt)})),v(a));let n=localStorage.getItem(ex.UI_STATE);if(n){let e=JSON.parse(n);if(D(e.isTopSectionCollapsed||!1),e.currentConversationId&&a.length>0){let t=a.find(t=>t.id===e.currentConversationId);if(t){C(e.currentConversationId),j(t.messages);let a=_(t.messages,t.id,new Date(t.updatedAt));f(a),h(0)}}}}catch(e){console.warn("Failed to load saved AI Builder data:",e)}},[]),(0,r.useEffect)(()=>{if(l)try{localStorage.setItem(ex.PROVIDER_CONFIG,JSON.stringify(l))}catch(e){console.warn("Failed to save provider config:",e)}},[l]),(0,r.useEffect)(()=>{try{localStorage.setItem(ex.CONVERSATIONS,JSON.stringify(x))}catch(e){console.warn("Failed to save conversations:",e)}},[x]),(0,r.useEffect)(()=>{try{localStorage.setItem(ex.UI_STATE,JSON.stringify({isTopSectionCollapsed:S,currentConversationId:N}))}catch(e){console.warn("Failed to save UI state:",e)}},[S,N]);let O=(0,r.useCallback)(e=>{d(e)},[]),F=(0,r.useCallback)(e=>{let t={id:"form_".concat(Date.now()),code:e,timestamp:new Date};f(e=>{let a=[...e,t];return h(a.length-1),a}),null==a||a(e)},[a]),T=(0,r.useCallback)(e=>{y(e)},[]),L=(0,r.useCallback)(e=>{console.log("Form submitted:",e),null==i||i(e)},[i]),z=(0,r.useCallback)(e=>{h(e)},[]),R=(0,r.useCallback)(e=>{f(t=>{let a=t.filter((t,a)=>a!==e);return e<=g&&g>0?h(g-1):e<g||(0===a.length?h(0):g>=a.length&&h(a.length-1)),a})},[g]),V=(0,r.useCallback)(function(e){if(arguments.length>1&&void 0!==arguments[1]&&arguments[1],!P())return void c.oR.error("Please configure your AI provider first",{description:"You need to set up your API key in the settings before you can chat."});if(j(e),e.length>0)if(N)v(t=>t.map(t=>t.id===N?{...t,messages:e,updatedAt:new Date}:t));else{let t="conversation_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9));v(a=>a.some(e=>e.id===t)?a:[...a,{id:t,title:"",messages:e,createdAt:new Date,updatedAt:new Date}]),C(t)}},[N,P]),q=(0,r.useCallback)(()=>{C(void 0),j([]),f([]),h(0)},[]),M=(0,r.useCallback)(e=>{C(e.id),j(e.messages);let t=_(e.messages,e.id,new Date(e.updatedAt));console.log("Extracted forms from conversation:",t.length),f(t),h(0)},[]),B=(0,r.useCallback)(e=>{v(t=>t.filter(t=>t.id!==e)),N===e&&(C(void 0),j([]),f([]),h(0))},[N]),U=(0,r.useCallback)(e=>{let t="data:application/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(e,null,2)),a="conversation-".concat(e.id,".json"),n=document.createElement("a");n.setAttribute("href",t),n.setAttribute("download",a),n.click()},[]),G=(0,r.useCallback)(()=>{I(!A)},[A]),J=(0,r.useCallback)(e=>{E(e),e&&A&&I(!1)},[A]);return(0,n.jsxs)("div",{className:(0,u.cn)("flex flex-col h-full overflow-hidden",t),children:[(0,n.jsxs)("div",{className:"flex items-center gap-2 px-1 pb-1 flex-shrink-0",children:[(0,n.jsx)(eb.A,{className:"h-4 w-4 text-primary"}),(0,n.jsx)("h1",{className:"text-lg font-bold text-foreground",children:"AI Form Builder"})]}),(0,n.jsxs)("div",{className:"flex-1 flex min-h-0 overflow-hidden gap-2",children:[(0,n.jsx)(en,{isCollapsed:A,onToggleCollapse:G,activeView:k,onViewChange:J}),(0,n.jsx)(eh,{activeView:k,isCollapsed:A,conversations:x,currentConversationId:N,onSelectConversation:M,onDeleteConversation:B,onNewConversation:q,onExportConversation:U,providerConfig:l,onConfigChange:O}),(0,n.jsxs)("div",{className:"flex-1 grid grid-cols-1 lg:grid-cols-2 gap-2 min-h-0 overflow-hidden",children:[P()?(0,n.jsx)(Z,{onFormGenerated:F,onStreamingStateChange:T,onConversationUpdate:V,onNewConversation:q,messages:w,providerConfig:l,mode:s,backendConfig:o,className:"h-full overflow-hidden"}):(0,n.jsxs)("div",{className:"flex flex-col h-full border-2 border-accent/30 rounded-lg shadow-lg bg-card",children:[(0,n.jsxs)("div",{className:"px-6 py-4 bg-gradient-to-r from-accent/10 to-transparent border-b",children:[(0,n.jsx)("h2",{className:"text-lg font-semibold text-foreground",children:"Setup Required"}),(0,n.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:"backend"===s?"Backend endpoint configuration is required":"Please configure your AI provider to start building forms"})]}),(0,n.jsx)("div",{className:"flex-1 overflow-y-auto",children:"direct"===s?(0,n.jsx)(m,{onConfigChange:O,initialConfig:l,className:"h-full"}):(0,n.jsx)("div",{className:"p-6",children:(0,n.jsxs)("div",{className:"text-center text-muted-foreground",children:[(0,n.jsx)("h3",{className:"text-base font-medium mb-2",children:"Backend Mode"}),(0,n.jsx)("p",{className:"text-sm",children:(null==o?void 0:o.endpoint)?"Endpoint: ".concat(o.endpoint):"No backend endpoint configured"}),(0,n.jsx)("p",{className:"text-xs mt-4",children:"Backend configuration must be provided via props by the developer."})]})})})]}),(0,n.jsx)(Q,{forms:p,currentFormIndex:g,onFormIndexChange:z,onDeleteForm:R,isStreaming:b,onFormSubmit:L,className:"h-full overflow-hidden"})]})]})]})}function eN(e){return(0,n.jsx)(o.Ht,{client:ey,children:(0,n.jsx)(ev,{...e})})}function eC(){return(0,n.jsx)("div",{className:"h-[calc(100vh-4rem)] bg-background",children:(0,n.jsx)(i.P.div,{className:"h-full p-2",initial:{y:30,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2},children:(0,n.jsx)("div",{className:"bg-card border rounded-lg shadow-sm h-full p-2",children:(0,n.jsx)(eN,{className:"h-full w-full"})})})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[803,637,0,283,852,826,389,486,318,587,315,358],()=>t(24265)),_N_E=e.O()}]);